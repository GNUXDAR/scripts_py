
<!DOCTYPE html>

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta property="og:title" content="optparse — Analizador sintáctico (parser) para opciones de línea de comandos" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://docs.python.org/3/library/optparse.html" />
<meta property="og:site_name" content="Python documentation" />
<meta property="og:description" content="Source code: Lib/optparse.py optparse es una biblioteca más conveniente, flexible y poderosa para analizar opciones de línea de comandos que el antiguo módulo getopt. optparse usa un estilo más dec..." />
<meta property="og:image" content="https://docs.python.org/3/_static/og-image.png" />
<meta property="og:image:alt" content="Python documentation" />
<meta name="description" content="Source code: Lib/optparse.py optparse es una biblioteca más conveniente, flexible y poderosa para analizar opciones de línea de comandos que el antiguo módulo getopt. optparse usa un estilo más dec..." />
<meta property="og:image:width" content="200" />
<meta property="og:image:height" content="200" />
<meta name="theme-color" content="#3776ab" />

    <title>optparse — Analizador sintáctico (parser) para opciones de línea de comandos &#8212; documentación de Python - 3.11.2</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/pydoctheme.css?digest=2d3badd06fe70b34b68db01f99471ce1624ffe4a" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    
    <script src="../_static/sidebar.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Buscar en documentación de Python - 3.11.2"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="Sobre este documento" href="../about.html" />
    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Búsqueda" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="ossaudiodev — Acceso a dispositivos de audio compatibles con OSS" href="ossaudiodev.html" />
    <link rel="prev" title="nntplib — Protocolo de cliente NNTP" href="nntplib.html" />
    <link rel="canonical" href="https://docs.python.org/3/library/optparse.html" />
    
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>
<link rel="shortcut icon" type="image/png" href="../_static/py.svg" />
            <script type="text/javascript" src="../_static/copybutton.js"></script>
            <script type="text/javascript" src="../_static/menu.js"></script> 

  </head>
<body>
<div class="mobile-nav">
    <input type="checkbox" id="menuToggler" class="toggler__input" aria-controls="navigation"
           aria-pressed="false" aria-expanded="false" role="button" aria-label="Menu" />
    <label for="menuToggler" class="toggler__label">
        <span></span>
    </label>
    <nav class="nav-content" role="navigation">
         <a href="https://www.python.org/" class="nav-logo">
             <img src="../_static/py.svg" alt="Logo"/>
         </a>
        <div class="version_switcher_placeholder"></div>
        <form role="search" class="search" action="../search.html" method="get">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="search-icon">
                <path fill-rule="nonzero"
                        d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" fill="#444"></path>
            </svg>
            <input type="text" name="q" aria-label="Búsqueda rápida"/>
            <input type="submit" value="Ir"/>
        </form>
    </nav>
    <div class="menu-wrapper">
        <nav class="menu" role="navigation" aria-label="main navigation">
            <div class="language_switcher_placeholder"></div>
  <div>
    <h3><a href="../contents.html">Tabla de contenido</a></h3>
    <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code> — Analizador sintáctico (parser) para opciones de línea de comandos</a><ul>
<li><a class="reference internal" href="#background">Contexto</a><ul>
<li><a class="reference internal" href="#terminology">Terminología</a></li>
<li><a class="reference internal" href="#what-are-options-for">¿Qué finalidad tienen las opciones?</a></li>
<li><a class="reference internal" href="#what-are-positional-arguments-for">¿Qué finalidad tienen los argumentos posicionales?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tutorial">Tutorial</a><ul>
<li><a class="reference internal" href="#understanding-option-actions">Comprendiendo las acciones de opción</a></li>
<li><a class="reference internal" href="#the-store-action">La acción store</a></li>
<li><a class="reference internal" href="#handling-boolean-flag-options">Manejo de opciones booleanas (flags)</a></li>
<li><a class="reference internal" href="#other-actions">Otras acciones</a></li>
<li><a class="reference internal" href="#default-values">Valores por defecto</a></li>
<li><a class="reference internal" href="#generating-help">Generando ayuda</a><ul>
<li><a class="reference internal" href="#grouping-options">Agrupando opciones</a></li>
</ul>
</li>
<li><a class="reference internal" href="#printing-a-version-string">Imprimir una cadena de caracteres con la versión del programa</a></li>
<li><a class="reference internal" href="#how-optparse-handles-errors">Cómo maneja los errores el módulo <code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a></li>
<li><a class="reference internal" href="#putting-it-all-together">Reuniendo todas las piezas</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reference-guide">Guía de referencia</a><ul>
<li><a class="reference internal" href="#creating-the-parser">Creando el analizador sintáctico (parser)</a></li>
<li><a class="reference internal" href="#populating-the-parser">Completando el analizador con opciones</a></li>
<li><a class="reference internal" href="#defining-options">Definiendo las opciones</a></li>
<li><a class="reference internal" href="#option-attributes">Atributos de opción</a></li>
<li><a class="reference internal" href="#standard-option-actions">Acciones de opción estándares</a></li>
<li><a class="reference internal" href="#standard-option-types">Tipos de opción estándares</a></li>
<li><a class="reference internal" href="#parsing-arguments">Analizando los argumentos</a></li>
<li><a class="reference internal" href="#querying-and-manipulating-your-option-parser">Consultar y manipular el analizador de opciones</a></li>
<li><a class="reference internal" href="#conflicts-between-options">Conflictos entre opciones</a></li>
<li><a class="reference internal" href="#cleanup">Limpieza</a></li>
<li><a class="reference internal" href="#other-methods">Otros métodos</a></li>
</ul>
</li>
<li><a class="reference internal" href="#option-callbacks">Retrollamadas de opción</a><ul>
<li><a class="reference internal" href="#defining-a-callback-option">Definición de una opción con retrollamada</a></li>
<li><a class="reference internal" href="#how-callbacks-are-called">Cómo son invocadas las retrollamadas</a></li>
<li><a class="reference internal" href="#raising-errors-in-a-callback">Lanzando errores en una retrollamada</a></li>
<li><a class="reference internal" href="#callback-example-1-trivial-callback">Ejemplo de retrollamada 1: una retrollamada trivial</a></li>
<li><a class="reference internal" href="#callback-example-2-check-option-order">Ejemplo de retrollamada 2: comprobar el orden de las opciones</a></li>
<li><a class="reference internal" href="#callback-example-3-check-option-order-generalized">Ejemplo de retrollamada 3: comprobar el orden de las opciones (generalizado)</a></li>
<li><a class="reference internal" href="#callback-example-4-check-arbitrary-condition">Ejemplo de retrollamada 4: comprobar una condición arbitraria</a></li>
<li><a class="reference internal" href="#callback-example-5-fixed-arguments">Ejemplo de retrollamada 5: argumentos fijos</a></li>
<li><a class="reference internal" href="#callback-example-6-variable-arguments">Ejemplo de retrollamada 6: argumentos variables</a></li>
</ul>
</li>
<li><a class="reference internal" href="#extending-optparse">Extendiendo el módulo <code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a><ul>
<li><a class="reference internal" href="#adding-new-types">Agregando nuevos tipos</a></li>
<li><a class="reference internal" href="#adding-new-actions">Agregando nuevas acciones</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Tema anterior</h4>
    <p class="topless"><a href="nntplib.html"
                          title="capítulo anterior"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nntplib</span></code> — Protocolo de cliente NNTP</a></p>
  </div>
  <div>
    <h4>Próximo tema</h4>
    <p class="topless"><a href="ossaudiodev.html"
                          title="próximo capítulo"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ossaudiodev</span></code> — Acceso a dispositivos de audio compatibles con OSS</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>Esta página</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">Reporta un bug</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/3.11/Doc/library/optparse.rst"
            rel="nofollow">Ver fuente
        </a>
      </li>
    </ul>
  </div>
        </nav>
    </div>
</div>

  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Índice general"
             accesskey="I">índice</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Índice de Módulos Python"
             >módulos</a> |</li>
        <li class="right" >
          <a href="ossaudiodev.html" title="ossaudiodev — Acceso a dispositivos de audio compatibles con OSS"
             accesskey="N">siguiente</a> |</li>
        <li class="right" >
          <a href="nntplib.html" title="nntplib — Protocolo de cliente NNTP"
             accesskey="P">anterior</a> |</li>

          <li><img src="../_static/py.svg" alt="python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.11.2 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >La biblioteca estándar de Python</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="superseded.html" accesskey="U">Módulos reemplazados</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code> — Analizador sintáctico (parser) para opciones de línea de comandos</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Búsqueda rápida" aria-label="Búsqueda rápida" type="text" name="q" />
          <input type="submit" value="Ir" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
                     |
                </li>
            
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-optparse">
<span id="optparse-parser-for-command-line-options"></span><h1><a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> — Analizador sintáctico (parser) para opciones de línea de comandos<a class="headerlink" href="#module-optparse" title="Enlazar permanentemente con este título">¶</a></h1>
<p><strong>Source code:</strong> <a class="reference external" href="https://github.com/python/cpython/tree/3.11/Lib/optparse.py">Lib/optparse.py</a></p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Obsoleto desde la versión 3.2: </span>El módulo <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> está obsoleto y no será desarrollado de aquí en adelante. El desarrollo continuará en el módulo <a class="reference internal" href="argparse.html#module-argparse" title="argparse: Command-line option and argument parsing library."><code class="xref py py-mod docutils literal notranslate"><span class="pre">argparse</span></code></a>.</p>
</div>
<hr class="docutils" />
<p><a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> es una biblioteca más conveniente, flexible y poderosa para analizar opciones de línea de comandos que el antiguo módulo <a class="reference internal" href="getopt.html#module-getopt" title="getopt: Portable parser for command line options; support both short and long option names."><code class="xref py py-mod docutils literal notranslate"><span class="pre">getopt</span></code></a>. <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> usa un estilo más declarativo: creas una instancia de <a class="reference internal" href="#optparse.OptionParser" title="optparse.OptionParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptionParser</span></code></a>, le añades las opciones deseadas y realizas el análisis sintáctico de la línea de comandos. <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> permite a los usuarios especificar opciones siguiendo la sintaxis convencional de GNU/POSIX, además de generar mensajes de uso y de ayuda automáticamente.</p>
<p>A continuación puedes ver un ejemplo de uso de <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> mediante un script simple:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">optparse</span> <span class="kn">import</span> <span class="n">OptionParser</span>
<span class="o">...</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">()</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="s2">&quot;--file&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;filename&quot;</span><span class="p">,</span>
                  <span class="n">help</span><span class="o">=</span><span class="s2">&quot;write report to FILE&quot;</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;FILE&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-q&quot;</span><span class="p">,</span> <span class="s2">&quot;--quiet&quot;</span><span class="p">,</span>
                  <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_false&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">help</span><span class="o">=</span><span class="s2">&quot;don&#39;t print status messages to stdout&quot;</span><span class="p">)</span>

<span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</pre></div>
</div>
<p>Con estas pocas líneas de código, los usuarios de tu script ahora pueden hacer un uso «normal» del mismo mediante la línea de comandos, por ejemplo:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">yourscript</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">file</span><span class="o">=</span><span class="n">outfile</span> <span class="o">-</span><span class="n">q</span>
</pre></div>
</div>
<p>A medida que analiza la línea de comandos, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> establece los atributos del objeto <code class="docutils literal notranslate"><span class="pre">options</span></code> retornado por <code class="xref py py-meth docutils literal notranslate"><span class="pre">parse_args()</span></code> basándose en los valores de la línea de comandos proporcionada por el usuario. Cuando <code class="xref py py-meth docutils literal notranslate"><span class="pre">parse_args()</span></code> termina de analizar esta línea de comandos, <code class="docutils literal notranslate"><span class="pre">options.filename</span></code> será <code class="docutils literal notranslate"><span class="pre">&quot;outfile&quot;</span></code> y <code class="docutils literal notranslate"><span class="pre">options.verbose</span></code> será <code class="docutils literal notranslate"><span class="pre">False</span></code>. <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> admite opciones largas y cortas, fusionar opciones cortas y asociar opciones con sus argumentos de diversas formas. Por lo tanto, las siguientes líneas de comandos son todas equivalentes al ejemplo previo:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">yourscript</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">f</span> <span class="n">outfile</span> <span class="o">--</span><span class="n">quiet</span>
<span class="o">&lt;</span><span class="n">yourscript</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">quiet</span> <span class="o">--</span><span class="n">file</span> <span class="n">outfile</span>
<span class="o">&lt;</span><span class="n">yourscript</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">q</span> <span class="o">-</span><span class="n">foutfile</span>
<span class="o">&lt;</span><span class="n">yourscript</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">qfoutfile</span>
</pre></div>
</div>
<p>Además, los usuarios pueden ejecutar uno de los siguientes:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">yourscript</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">h</span>
<span class="o">&lt;</span><span class="n">yourscript</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">help</span>
</pre></div>
</div>
<p>y <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> imprimirá un breve resumen de las opciones de tu script:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Usage: &lt;yourscript&gt; [options]

Options:
  -h, --help            show this help message and exit
  -f FILE, --file=FILE  write report to FILE
  -q, --quiet           don&#39;t print status messages to stdout
</pre></div>
</div>
<p>donde el valor de <em>yourscript</em> se determina en tiempo de ejecución (normalmente a partir de <code class="docutils literal notranslate"><span class="pre">sys.argv</span> <span class="pre">[0]</span></code>).</p>
<section id="background">
<span id="optparse-background"></span><h2>Contexto<a class="headerlink" href="#background" title="Enlazar permanentemente con este título">¶</a></h2>
<p><a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> ha sido diseñado explícitamente para fomentar la creación de programas con interfaces de línea de comandos convencionales y sencillas. Con ese fin en mente, solo admite la sintaxis y semántica de línea de comandos más común y convencionalmente usada en Unix. Si no estás familiarizado con estas convenciones, lee esta sección para familiarizarte con ellas.</p>
<section id="terminology">
<span id="optparse-terminology"></span><h3>Terminología<a class="headerlink" href="#terminology" title="Enlazar permanentemente con este título">¶</a></h3>
<dl>
<dt>argumento</dt><dd><p>una cadena de caracteres ingresada en la línea de comandos y pasada mediante la shell a <code class="docutils literal notranslate"><span class="pre">execl()</span></code> o <code class="docutils literal notranslate"><span class="pre">execv()</span></code>. En Python, los argumentos son elementos de <code class="docutils literal notranslate"><span class="pre">sys.argv[1:]</span></code> (dado que <code class="docutils literal notranslate"><span class="pre">sys.argv[0]</span></code> es el propio nombre del programa que se está ejecutando). Las shells de Unix también usan el término «<em>word</em>» (“palabra”) para referirse a ellos.</p>
<p>En ocasiones es deseable proporcionar una lista de argumentos que no sea <code class="docutils literal notranslate"><span class="pre">sys.argv[1:]</span></code>, por lo que deberías considerar un “argumento” como “un elemento de <code class="docutils literal notranslate"><span class="pre">sys.argv[1:]</span></code> o de alguna otra lista proporcionada como sustituto de <code class="docutils literal notranslate"><span class="pre">sys.argv[1:]</span></code>”.</p>
</dd>
<dt>opción</dt><dd><p>un argumento utilizado para proporcionar información adicional con la finalidad de guiar o personalizar la ejecución de un programa. Existen muchas sintaxis diferentes para especificar opciones. La sintaxis tradicional de Unix es un guion (“-”) seguido de una sola letra, por ejemplo <code class="docutils literal notranslate"><span class="pre">-x</span></code> o <code class="docutils literal notranslate"><span class="pre">-F</span></code>. La sintaxis tradicional de Unix permite además fusionar múltiples opciones en un solo argumento, por ejemplo <code class="docutils literal notranslate"><span class="pre">-x</span> <span class="pre">-F</span></code> es equivalente a <code class="docutils literal notranslate"><span class="pre">-xF</span></code>. Por otro lado, el proyecto GNU introdujo <code class="docutils literal notranslate"><span class="pre">--</span></code> seguido de una serie de palabras separadas por guiones, por ejemplo <code class="docutils literal notranslate"><span class="pre">--file</span></code> o <code class="docutils literal notranslate"><span class="pre">--dry-run</span></code>. Estas son las dos únicas sintaxis para opciones que el módulo <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> proporciona.</p>
<p>Algunas de las otras sintaxis para opciones que el mundo ha visto son:</p>
<ul class="simple">
<li><p>un guion seguido de algunas letras, por ejemplo <code class="docutils literal notranslate"><span class="pre">-pf</span></code> (esto <em>no</em> es lo mismo que múltiples opciones fusionadas en un solo argumento)</p></li>
<li><p>un guion seguido de una palabra completa, por ejemplo <code class="docutils literal notranslate"><span class="pre">-file</span></code> (esto es técnicamente equivalente a la sintaxis anterior, pero generalmente no se ven ambas en un mismo programa)</p></li>
<li><p>un signo más seguido de una sola letra, unas pocas letras o una palabra, por ejemplo <code class="docutils literal notranslate"><span class="pre">+f</span></code> o <code class="docutils literal notranslate"><span class="pre">+rgb</span></code></p></li>
<li><p>una barra seguida de una letra, de unas pocas letras o de una palabra, por ejemplo <code class="docutils literal notranslate"><span class="pre">/f</span></code> o <code class="docutils literal notranslate"><span class="pre">/file</span></code></p></li>
</ul>
<p>These option syntaxes are not supported by <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a>, and they never
will be.  This is deliberate: the first three are non-standard on any
environment, and the last only makes sense if you’re exclusively targeting
Windows or certain legacy platforms (e.g. VMS, MS-DOS).</p>
</dd>
<dt>argumento de opción</dt><dd><p>un argumento que sigue a una opción, está estrechamente asociado con ella y se consume de la lista de argumentos cuando esa opción es consumida. Con <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a>, los argumentos de las opciones pueden estar en un argumento separado de su opción:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>-f foo
--file foo
</pre></div>
</div>
<p>o incluidos en el mismo argumento:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>-ffoo
--file=foo
</pre></div>
</div>
<p>Normalmente, una opción dada puede aceptar o no un argumento. Mucha gente desea una característica de «argumentos de opción opcionales», lo que implica que algunas opciones aceptarán un argumento si está presente y no lo aceptarán si no lo está. Esto es algo controvertido, porque hace que el análisis sea ambiguo: si <code class="docutils literal notranslate"><span class="pre">-a</span></code> toma un argumento opcional y <code class="docutils literal notranslate"><span class="pre">-b</span></code> es otra opción completamente distinta, ¿cómo interpretamos <code class="docutils literal notranslate"><span class="pre">-ab</span></code>? Debido a esta ambigüedad, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> no es compatible con esta funcionalidad.</p>
</dd>
<dt>argumento posicional</dt><dd><p>es algo que queda en la lista de argumentos después de que las opciones hayan sido analizadas sintácticamente, es decir, después de que las opciones y sus argumentos hayan sido analizados y eliminados de la lista de argumentos.</p>
</dd>
<dt>opción requerida</dt><dd><p>es una opción que debe proporcionarse forzosamente en la línea de comandos. Ten en cuenta que la frase «opción requerida» se contradice a si misma. <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> no te impide implementar opciones requeridas, pero tampoco brinda mucha ayuda para ello.</p>
</dd>
</dl>
<p>Por ejemplo, considera esta hipotética linea de comandos:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">prog</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">report</span> <span class="n">report</span><span class="o">.</span><span class="n">txt</span> <span class="n">foo</span> <span class="n">bar</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">-v</span></code> y <code class="docutils literal notranslate"><span class="pre">--report</span></code> son ambas opciones. <code class="docutils literal notranslate"><span class="pre">report.txt</span></code> es un argumento de opción, suponiendo que <code class="docutils literal notranslate"><span class="pre">--report</span></code> toma un argumento. En cambio, <code class="docutils literal notranslate"><span class="pre">foo</span></code> y <code class="docutils literal notranslate"><span class="pre">bar</span></code> son ambos argumentos posicionales.</p>
</section>
<section id="what-are-options-for">
<span id="optparse-what-options-for"></span><h3>¿Qué finalidad tienen las opciones?<a class="headerlink" href="#what-are-options-for" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Las opciones se utilizan para poder proporcionar información adicional con el fin de ajustar o personalizar la ejecución de un programa. Por si aún no ha quedado claro, las opciones suelen ser <em>opcionales</em>. Un programa debería poder ejecutarse sin problemas sin ninguna opción. (Elija un programa aleatorio del conjunto de herramientas de Unix o GNU. ¿Puede ejecutarse sin ninguna opción y aún así tener sentido? Las principales excepciones son <code class="docutils literal notranslate"><span class="pre">find</span></code>, <code class="docutils literal notranslate"><span class="pre">tar</span></code> y <code class="docutils literal notranslate"><span class="pre">dd</span></code>—los cuales son todos bichos raros mutantes que han sido apropiadamente criticados por su sintaxis no estándar y por tener interfaces confusas).</p>
<p>Como se ha comentado, mucha gente quiere que sus programas tengan «opciones requeridas». Pero pensemos en ello detenidamente. ¡Si es necesario, entonces <em>no es opcional</em>! Si hay una pieza de información absolutamente requerida para que tu programa pueda ejecutarse correctamente no uses opciones, para eso están los argumentos posicionales.</p>
<p>Como ejemplo de un buen diseño de una interfaz de línea de comandos, considera la humilde herramienta <code class="docutils literal notranslate"><span class="pre">cp</span></code> para copiar archivos. No tiene mucho sentido intentar copiar archivos sin proporcionar un destino y al menos una fuente de origen. Por lo tanto, <code class="docutils literal notranslate"><span class="pre">cp</span></code> falla si lo ejecutas sin argumentos. Sin embargo, tiene una sintaxis flexible y útil que no requiere ninguna opción:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">cp</span> <span class="n">SOURCE</span> <span class="n">DEST</span>
<span class="n">cp</span> <span class="n">SOURCE</span> <span class="o">...</span> <span class="n">DEST</span><span class="o">-</span><span class="n">DIR</span>
</pre></div>
</div>
<p>Puedes hacer mucho simplemente con eso. La mayoría de las implementaciones de <code class="docutils literal notranslate"><span class="pre">cp</span></code> proporcionan un montón de opciones para modificar exactamente cómo se copian los archivos: se puede preservar el modo y la fecha de modificación, evitar que se sigan enlaces simbólicos, preguntar antes de sobrescribir el contenido de archivos existentes, etc. Pero nada de esto distrae de la misión principal de <code class="docutils literal notranslate"><span class="pre">cp</span></code>, que consiste en copiar uno o varios archivos en otro directorio.</p>
</section>
<section id="what-are-positional-arguments-for">
<span id="optparse-what-positional-arguments-for"></span><h3>¿Qué finalidad tienen los argumentos posicionales?<a class="headerlink" href="#what-are-positional-arguments-for" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Los argumentos posicionales son adecuados para aquellas piezas de información que tu programa, absolutamente y sin duda alguna, requiere para funcionar.</p>
<p>Una buena interfaz de usuario debería tener la menor cantidad de requisitos absolutos posibles. Si tu programa requiere 17 piezas distintas de información para ejecutarse correctamente, no importa mucho <em>cómo</em> obtengas esa información del usuario; la mayoría de ellos se rendirán y se irán antes de ejecutar con éxito el programa. Esto se aplica tanto si la interfaz de usuario es una línea de comandos, un archivo de configuración o una GUI: si hace demasiadas demandas a sus usuarios, la mayoría simplemente se rendirá.</p>
<p>En resumen, trata de minimizar la cantidad de información que los usuarios están absolutamente obligados a proporcionar, utiliza valores predeterminados sensatos siempre que sea posible. Como es natural, también deseas que tus programas sean razonablemente flexibles, para eso están las opciones. De nuevo, no importa si son entradas en un archivo de configuración, widgets en un cuadro de diálogo de «Preferencias» de una GUI u opciones en la línea de comandos; cuantas más opciones implementes, más flexible será tu programa y más complicada se vuelve su implementación. Una excesiva flexibilidad evidentemente también tiene inconvenientes, demasiadas opciones pueden abrumar a los usuarios y hacer que tu código sea mucho más difícil de mantener.</p>
</section>
</section>
<section id="tutorial">
<span id="optparse-tutorial"></span><h2>Tutorial<a class="headerlink" href="#tutorial" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Si bien <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> es bastante flexible y potente, también es sencillo de usar en la mayoría de los casos. Esta sección cubre los patrones de código comunes a cualquier programa basado en <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a>.</p>
<p>En primer lugar, necesitas importar la clase OptionParser y luego, al comienzo del programa principal, crear una instancia de ella:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">optparse</span> <span class="kn">import</span> <span class="n">OptionParser</span>
<span class="o">...</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">()</span>
</pre></div>
</div>
<p>Ahora ya puedes comenzar a definir opciones. La sintaxis básica es:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="n">opt_str</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>
                  <span class="n">attr</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>Cada opción tiene una o más cadenas de caracteres de opción, como <code class="docutils literal notranslate"><span class="pre">-f</span></code> o <code class="docutils literal notranslate"><span class="pre">--file</span></code> y varios atributos de opción que le dicen a <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> qué esperar y qué hacer cuando encuentra esa opción en la línea de comandos.</p>
<p>Normalmente, cada opción tendrá una cadena de opción corta y una cadena de opción larga, por ejemplo:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="s2">&quot;--file&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>Puedes definir tantas cadenas de opción cortas y tantas largas como desees (incluso ninguna), siempre que haya al menos una cadena de opción en total.</p>
<p>Las cadenas de opción pasadas a <a class="reference internal" href="#optparse.OptionParser.add_option" title="optparse.OptionParser.add_option"><code class="xref py py-meth docutils literal notranslate"><span class="pre">OptionParser.add_option()</span></code></a> son en definitiva etiquetas para la opción definida por esa llamada. Simplemente por brevedad, con frecuencia nos referiremos a <em>encontrar una opción</em> en la línea de comandos. En realidad, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> encuentra <em>cadenas de caracteres de opción</em> y busca opciones en ellas.</p>
<p>Una vez que todas tus opciones estén definidas, indica a <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> que analice sintácticamente la línea de comandos de tu programa:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</pre></div>
</div>
<p>(Si lo deseas, puedes pasar una lista de argumentos personalizada a <code class="xref py py-meth docutils literal notranslate"><span class="pre">parse_args()</span></code>, pero eso rara vez es necesario: por defecto se usa <code class="docutils literal notranslate"><span class="pre">sys.argv</span> <span class="pre">[1:]</span></code>.)</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">parse_args()</span></code> retorna dos valores:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">options</span></code>, un objeto que contiene valores para todas tus opciones. Por ejemplo, si <code class="docutils literal notranslate"><span class="pre">--file</span></code> toma un argumento de una sola cadena de caracteres, entonces <code class="docutils literal notranslate"><span class="pre">options.file</span></code> será el nombre del archivo proporcionado por el usuario o <code class="docutils literal notranslate"><span class="pre">None</span></code> si el usuario no proporcionó esa opción en la linea de comandos</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">args</span></code>, la lista de argumentos posicionales que quedan después de analizar las opciones</p></li>
</ul>
<p>Este tutorial solo cubre los cuatro atributos de opción más importantes: <a class="reference internal" href="#optparse.Option.action" title="optparse.Option.action"><code class="xref py py-attr docutils literal notranslate"><span class="pre">action</span></code></a>, <a class="reference internal" href="#optparse.Option.type" title="optparse.Option.type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">type</span></code></a>, <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a> (destino) y <a class="reference internal" href="#optparse.Option.help" title="optparse.Option.help"><code class="xref py py-attr docutils literal notranslate"><span class="pre">help</span></code></a>. De todos ellos, <a class="reference internal" href="#optparse.Option.action" title="optparse.Option.action"><code class="xref py py-attr docutils literal notranslate"><span class="pre">action</span></code></a> es el fundamental.</p>
<section id="understanding-option-actions">
<span id="optparse-understanding-option-actions"></span><h3>Comprendiendo las acciones de opción<a class="headerlink" href="#understanding-option-actions" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Las acciones le dicen a <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> qué hacer cuando encuentra una determinada opción en la línea de comandos. Hay un conjunto fijo de acciones codificadas en <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a>. Agregar nuevas acciones es un tema avanzado cubierto en la sección <a class="reference internal" href="#optparse-extending-optparse"><span class="std std-ref">Extendiendo el módulo optparse</span></a>. La mayoría de las acciones indican a <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> que almacene un valor en alguna variable, por ejemplo, tomar una cadena de caracteres de la línea de comandos y almacenarla en un atributo del objeto <code class="docutils literal notranslate"><span class="pre">options</span></code>.</p>
<p>Si no se especifica una acción para la opción, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> usa por defecto <code class="docutils literal notranslate"><span class="pre">store</span></code>.</p>
</section>
<section id="the-store-action">
<span id="optparse-store-action"></span><h3>La acción store<a class="headerlink" href="#the-store-action" title="Enlazar permanentemente con este título">¶</a></h3>
<p>La acción para opciones más común es <code class="docutils literal notranslate"><span class="pre">store</span></code>, que le dice a <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> que tome el siguiente argumento (o el resto del argumento actual), se asegure de que sea del tipo correcto y lo guarde en el destino elegido.</p>
<p>Por ejemplo:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="s2">&quot;--file&quot;</span><span class="p">,</span>
                  <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;filename&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Ahora creamos una línea de comandos simulada y le pedimos a <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> que la analice:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="s2">&quot;foo.txt&quot;</span><span class="p">]</span>
<span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</pre></div>
</div>
<p>Cuando <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> se encuentra con la cadena de opción <code class="docutils literal notranslate"><span class="pre">-f</span></code>, consume el siguiente argumento, <code class="docutils literal notranslate"><span class="pre">foo.txt</span></code> y lo almacena en <code class="docutils literal notranslate"><span class="pre">options.filename</span></code>. Por lo tanto, después de la llamada a <code class="xref py py-meth docutils literal notranslate"><span class="pre">parse_args()</span></code>, <code class="docutils literal notranslate"><span class="pre">options.filename</span></code> será <code class="docutils literal notranslate"><span class="pre">&quot;foo.txt&quot;</span></code>.</p>
<p>Algunos de los otros tipos de opción admitidos por <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> son <code class="docutils literal notranslate"><span class="pre">int</span></code> y <code class="docutils literal notranslate"><span class="pre">float</span></code>. Aquí hay una opción que espera un argumento entero:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-n&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;num&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Ten en cuenta que esta opción no tiene una cadena de opción larga, lo cual es perfectamente aceptable. Además, no hay ninguna acción explícita, ya que el valor predeterminado es <code class="docutils literal notranslate"><span class="pre">store</span></code>.</p>
<p>Analicemos otra línea de comandos simulada. En esta ocasión, vamos a proporcionar el argumento de la opción pegado junto a la misma, sin separación entre ambos: dado que <code class="docutils literal notranslate"><span class="pre">-n42</span></code> (un argumento) es equivalente a <code class="docutils literal notranslate"><span class="pre">-n</span> <span class="pre">42</span></code> (dos argumentos), el código:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">([</span><span class="s2">&quot;-n42&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">num</span><span class="p">)</span>
</pre></div>
</div>
<p>imprimirá <code class="docutils literal notranslate"><span class="pre">42</span></code>.</p>
<p>Si no se especifica un tipo, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> asume <code class="docutils literal notranslate"><span class="pre">string</span></code>. Esto, combinado con el hecho de que la acción predeterminada es <code class="docutils literal notranslate"><span class="pre">store</span></code>, implica que nuestro primer ejemplo puede implementarse de forma mucho más concisa:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="s2">&quot;--file&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;filename&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Si no se proporciona un destino, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> infiere un destino por defecto adecuado a partir de las cadenas de opción proporcionadas: si la primera cadena de opción larga es <code class="docutils literal notranslate"><span class="pre">--foo-bar</span></code>, entonces el destino predeterminado es <code class="docutils literal notranslate"><span class="pre">foo_bar</span></code>. Si no hay cadenas de opción largas, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> mira la primera cadena de opción corta: por ejemplo, el destino predeterminado para <code class="docutils literal notranslate"><span class="pre">-f</span></code> es <code class="docutils literal notranslate"><span class="pre">f</span></code>.</p>
<p><a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> también incluye el tipo incorporado <code class="docutils literal notranslate"><span class="pre">complex</span></code>. La adición de nuevos tipos se cubre en la sección <a class="reference internal" href="#optparse-extending-optparse"><span class="std std-ref">Extendiendo el módulo optparse</span></a>.</p>
</section>
<section id="handling-boolean-flag-options">
<span id="optparse-handling-boolean-options"></span><h3>Manejo de opciones booleanas (flags)<a class="headerlink" href="#handling-boolean-flag-options" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Las opciones flags—establecen una variable en verdadero o falso cuando se encuentra una opción en particular— son bastante comunes. <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> las admite con dos acciones diferenciadas, <code class="docutils literal notranslate"><span class="pre">store_true</span></code> y <code class="docutils literal notranslate"><span class="pre">store_false</span></code>. Por ejemplo, puedes tener un flag <code class="docutils literal notranslate"><span class="pre">verbose</span></code> que se activa con <code class="docutils literal notranslate"><span class="pre">-v</span></code> y se desactiva con <code class="docutils literal notranslate"><span class="pre">-q</span></code>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-v&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-q&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_false&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Aquí tenemos dos opciones diferentes con el mismo destino, lo cual es totalmente correcto. Solo significa que debes tener un poco de cuidado al establecer los valores predeterminados, lo veremos a continuación.</p>
<p>Cuando <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> encuentra <code class="docutils literal notranslate"><span class="pre">-v</span></code> en la línea de comandos, establece <code class="docutils literal notranslate"><span class="pre">options.verbose</span></code> en <code class="docutils literal notranslate"><span class="pre">True</span></code>; cuando encuentra <code class="docutils literal notranslate"><span class="pre">-q</span></code>, <code class="docutils literal notranslate"><span class="pre">options.verbose</span></code> se establece en <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</section>
<section id="other-actions">
<span id="optparse-other-actions"></span><h3>Otras acciones<a class="headerlink" href="#other-actions" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Algunas de las otras acciones soportadas por <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> son:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">&quot;store_const&quot;</span></code></dt><dd><p>store a constant value, pre-set via <a class="reference internal" href="#optparse.Option.const" title="optparse.Option.const"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Option.const</span></code></a></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;append&quot;</span></code></dt><dd><p>agrega el argumento de esta opción a una lista</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;count&quot;</span></code></dt><dd><p>incrementa un contador en uno</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;callback&quot;</span></code></dt><dd><p>llama a una función específica</p>
</dd>
</dl>
<p>Estas acciones se tratan en la sección <a class="reference internal" href="#optparse-reference-guide"><span class="std std-ref">Guía de referencia</span></a> y en la sección <a class="reference internal" href="#optparse-option-callbacks"><span class="std std-ref">Retrollamadas de opción</span></a>.</p>
</section>
<section id="default-values">
<span id="optparse-default-values"></span><h3>Valores por defecto<a class="headerlink" href="#default-values" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Todos los ejemplos anteriores implican establecer alguna variable (el «destino») cuando aparecen ciertas opciones en la línea de comandos. ¿Qué pasa si esas opciones nunca se encuentran? Dado que no proporcionamos ningún valor predeterminado, todas las variables están establecidas en <code class="docutils literal notranslate"><span class="pre">None</span></code>. Por lo general, esto está bien, pero a veces se desea tener más control. <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> permite proporcionar un valor predeterminado para cada destino, que es asignado antes de analizar la línea de comandos.</p>
<p>Primero, considera el ejemplo verbose/quiet anterior. Si queremos que <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> establezca <code class="docutils literal notranslate"><span class="pre">verbose</span></code> en <code class="docutils literal notranslate"><span class="pre">True</span></code> a menos que encuentre <code class="docutils literal notranslate"><span class="pre">-q</span></code>, entonces podemos hacer lo siguiente:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-v&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-q&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_false&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Dado que los valores predeterminados se aplican a <em>destination</em> en lugar de a cualquier opción en particular y que estas dos opciones tienen el mismo destino, lo anterior es exactamente equivalente a:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-v&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-q&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_false&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Considera lo siguiente:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-v&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-q&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_false&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Nuevamente, el valor predeterminado para <code class="docutils literal notranslate"><span class="pre">verbose</span></code> será <code class="docutils literal notranslate"><span class="pre">True</span></code>: el último valor predeterminado proporcionado para cualquier destino en particular es el único que se tendrá en cuenta.</p>
<p>Una forma más clara de especificar valores predeterminados es el método <code class="xref py py-meth docutils literal notranslate"><span class="pre">set_defaults()</span></code> de OptionParser, al que puedes llamar en cualquier momento antes de llamar a <code class="xref py py-meth docutils literal notranslate"><span class="pre">parse_args()</span></code>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</pre></div>
</div>
<p>Como vimos antes, el último valor especificado para un destino de opción dado es el que cuenta. Para mayor claridad, intenta utilizar un método u otro para establecer valores predeterminados, no ambos.</p>
</section>
<section id="generating-help">
<span id="optparse-generating-help"></span><h3>Generando ayuda<a class="headerlink" href="#generating-help" title="Enlazar permanentemente con este título">¶</a></h3>
<p>La capacidad de <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> para generar ayuda y texto de uso automáticamente es útil para crear interfaces de línea de comandos fáciles de usar. Todo lo que tienes que hacer es proporcionar un valor <code class="xref py py-attr docutils literal notranslate"><span class="pre">help</span></code> para cada opción y, opcionalmente, un breve mensaje de uso para el programa en general. A continuación hay un OptionParser al que se le han añadido múltiples opciones fáciles de usar (documentadas):</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span> <span class="o">=</span> <span class="s2">&quot;usage: %prog [options] arg1 arg2&quot;</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="n">usage</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-v&quot;</span><span class="p">,</span> <span class="s2">&quot;--verbose&quot;</span><span class="p">,</span>
                  <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">help</span><span class="o">=</span><span class="s2">&quot;make lots of noise [default]&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-q&quot;</span><span class="p">,</span> <span class="s2">&quot;--quiet&quot;</span><span class="p">,</span>
                  <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_false&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span>
                  <span class="n">help</span><span class="o">=</span><span class="s2">&quot;be vewwy quiet (I&#39;m hunting wabbits)&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="s2">&quot;--filename&quot;</span><span class="p">,</span>
                  <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;FILE&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;write output to FILE&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-m&quot;</span><span class="p">,</span> <span class="s2">&quot;--mode&quot;</span><span class="p">,</span>
                  <span class="n">default</span><span class="o">=</span><span class="s2">&quot;intermediate&quot;</span><span class="p">,</span>
                  <span class="n">help</span><span class="o">=</span><span class="s2">&quot;interaction mode: novice, intermediate, &quot;</span>
                       <span class="s2">&quot;or expert [default: </span><span class="si">%d</span><span class="s2">efault]&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Si <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> encuentra <code class="docutils literal notranslate"><span class="pre">-h</span></code> o <code class="docutils literal notranslate"><span class="pre">--help</span></code> en la línea de comandos, o si simplemente se llama al método <code class="xref py py-meth docutils literal notranslate"><span class="pre">parser.print_help()</span></code>, se imprime lo siguiente en la salida estándar:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Usage: &lt;yourscript&gt; [options] arg1 arg2

Options:
  -h, --help            show this help message and exit
  -v, --verbose         make lots of noise [default]
  -q, --quiet           be vewwy quiet (I&#39;m hunting wabbits)
  -f FILE, --filename=FILE
                        write output to FILE
  -m MODE, --mode=MODE  interaction mode: novice, intermediate, or
                        expert [default: intermediate]
</pre></div>
</div>
<p>(Si la salida de ayuda se activa mediante una opción de ayuda, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> termina la ejecución después de imprimir el texto de ayuda.)</p>
<p>Estamos haciendo muchas cosas aquí con el fin de ayudar a que <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> genere el mejor mensaje de ayuda posible:</p>
<ul>
<li><p>el script define su propio mensaje de uso:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span> <span class="o">=</span> <span class="s2">&quot;usage: %prog [options] arg1 arg2&quot;</span>
</pre></div>
</div>
<p><a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> expande <code class="docutils literal notranslate"><span class="pre">%</span> <span class="pre">prog</span></code> en la cadena de uso reemplazándolo por el nombre del programa actual, es decir, <code class="docutils literal notranslate"><span class="pre">os.path.basename</span> <span class="pre">(sys.argv</span> <span class="pre">[0])</span></code>. A continuación, la cadena expandida se imprime antes de la ayuda detallada de la opción.</p>
<p>Si no proporcionas una cadena de uso, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> usa un valor predeterminado anodino pero apropiado: <code class="docutils literal notranslate"><span class="pre">&quot;Usage:</span> <span class="pre">%prog</span> <span class="pre">[options]&quot;</span></code>, lo cual está bien si tu script no toma ningún argumento posicional.</p>
</li>
<li><p>cada opción simplemente define una cadena de ayuda y no se preocupa por el ajuste de línea. <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> se encarga de ajustar las líneas y hacer que la salida de ayuda se vea bien.</p></li>
<li><p>options that take a value indicate this fact in their automatically generated
help message, e.g. for the «mode» option:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">m</span> <span class="n">MODE</span><span class="p">,</span> <span class="o">--</span><span class="n">mode</span><span class="o">=</span><span class="n">MODE</span>
</pre></div>
</div>
<p>Here, «MODE» is called the meta-variable: it stands for the argument that the
user is expected to supply to <code class="docutils literal notranslate"><span class="pre">-m</span></code>/<code class="docutils literal notranslate"><span class="pre">--mode</span></code>.  By default,
<a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> converts the destination variable name to uppercase and uses
that for the meta-variable.  Sometimes, that’s not what you want—for
example, the <code class="docutils literal notranslate"><span class="pre">--filename</span></code> option explicitly sets <code class="docutils literal notranslate"><span class="pre">metavar=&quot;FILE&quot;</span></code>,
resulting in this automatically generated option description:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">f</span> <span class="n">FILE</span><span class="p">,</span> <span class="o">--</span><span class="n">filename</span><span class="o">=</span><span class="n">FILE</span>
</pre></div>
</div>
<p>Sin embargo, esto es importante para algo más que para ahorrar espacio: el texto de ayuda escrito manualmente utiliza la metavariable <code class="docutils literal notranslate"><span class="pre">FILE</span></code> para indicarle al usuario que hay una conexión entre la sintaxis semiformal <code class="docutils literal notranslate"><span class="pre">-f</span> <span class="pre">FILE</span></code> y la descripción semántica informal «escribir la salida en FILE». Esta es una manera simple pero efectiva de hacer que tu texto de ayuda sea mucho más claro y útil para los usuarios finales.</p>
</li>
<li><p>las opciones que tienen un valor predeterminado pueden incluir <code class="docutils literal notranslate"><span class="pre">%default</span></code> en la cadena de ayuda, en cuyo caso, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> lo reemplazará por el resultado de aplicar <a class="reference internal" href="stdtypes.html#str" title="str"><code class="xref py py-func docutils literal notranslate"><span class="pre">str()</span></code></a> al valor por defecto de esa opción. Si una opción no tiene un valor por defecto (o el valor por defecto es <code class="docutils literal notranslate"><span class="pre">None</span></code>), <code class="docutils literal notranslate"><span class="pre">%default</span></code> se reemplazará por <code class="docutils literal notranslate"><span class="pre">none</span></code>.</p></li>
</ul>
<section id="grouping-options">
<h4>Agrupando opciones<a class="headerlink" href="#grouping-options" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Cuando se trabaja con muchas opciones, suele ser conveniente agruparlas para obtener una mejor salida de ayuda. La clase <a class="reference internal" href="#optparse.OptionParser" title="optparse.OptionParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptionParser</span></code></a> puede contener varios grupos de opciones, cada uno de los cuales puede contener múltiples opciones.</p>
<p>Podemos obtener un grupo de opciones usando la clase <a class="reference internal" href="#optparse.OptionGroup" title="optparse.OptionGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptionGroup</span></code></a>:</p>
<dl class="py class">
<dt class="sig sig-object py" id="optparse.OptionGroup">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">optparse.</span></span><span class="sig-name descname"><span class="pre">OptionGroup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parser</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#optparse.OptionGroup" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>donde</p>
<ul class="simple">
<li><p><em>parser</em> es la instancia de <a class="reference internal" href="#optparse.OptionParser" title="optparse.OptionParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptionParser</span></code></a> en la que se insertará el grupo</p></li>
<li><p><em>title</em> es el título dado al grupo</p></li>
<li><p><em>description</em>, opcional, es la descripción larga del grupo</p></li>
</ul>
</dd></dl>

<p>la clase <a class="reference internal" href="#optparse.OptionGroup" title="optparse.OptionGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptionGroup</span></code></a> hereda de <code class="xref py py-class docutils literal notranslate"><span class="pre">OptionContainer</span></code> (al igual que <a class="reference internal" href="#optparse.OptionParser" title="optparse.OptionParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptionParser</span></code></a>), por lo que el método <code class="xref py py-meth docutils literal notranslate"><span class="pre">add_option()</span></code> se puede usar para agregar una opción al grupo.</p>
<p>Una vez que se han declarado todas las opciones, usando el método <code class="xref py py-meth docutils literal notranslate"><span class="pre">add_option_group()</span></code> de la clase <a class="reference internal" href="#optparse.OptionParser" title="optparse.OptionParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptionParser</span></code></a> el grupo se agrega al analizador sintáctico previamente definido.</p>
<p>Agregar un <a class="reference internal" href="#optparse.OptionGroup" title="optparse.OptionGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptionGroup</span></code></a> a un analizador es fácil, continuando con el analizador definido en la sección anterior:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">group</span> <span class="o">=</span> <span class="n">OptionGroup</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s2">&quot;Dangerous Options&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Caution: use these options at your own risk.  &quot;</span>
                    <span class="s2">&quot;It is believed that some of them bite.&quot;</span><span class="p">)</span>
<span class="n">group</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-g&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Group option.&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option_group</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
</pre></div>
</div>
<p>Esto daría como resultado la siguiente salida de ayuda:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Usage: &lt;yourscript&gt; [options] arg1 arg2

Options:
  -h, --help            show this help message and exit
  -v, --verbose         make lots of noise [default]
  -q, --quiet           be vewwy quiet (I&#39;m hunting wabbits)
  -f FILE, --filename=FILE
                        write output to FILE
  -m MODE, --mode=MODE  interaction mode: novice, intermediate, or
                        expert [default: intermediate]

  Dangerous Options:
    Caution: use these options at your own risk.  It is believed that some
    of them bite.

    -g                  Group option.
</pre></div>
</div>
<p>Un ejemplo un poco más completo podría implicar el uso de más de un grupo, ampliando el ejemplo anterior:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">group</span> <span class="o">=</span> <span class="n">OptionGroup</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s2">&quot;Dangerous Options&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Caution: use these options at your own risk.  &quot;</span>
                    <span class="s2">&quot;It is believed that some of them bite.&quot;</span><span class="p">)</span>
<span class="n">group</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-g&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Group option.&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option_group</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>

<span class="n">group</span> <span class="o">=</span> <span class="n">OptionGroup</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="s2">&quot;Debug Options&quot;</span><span class="p">)</span>
<span class="n">group</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-d&quot;</span><span class="p">,</span> <span class="s2">&quot;--debug&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
                 <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Print debug information&quot;</span><span class="p">)</span>
<span class="n">group</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-s&quot;</span><span class="p">,</span> <span class="s2">&quot;--sql&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
                 <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Print all SQL statements executed&quot;</span><span class="p">)</span>
<span class="n">group</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-e&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Print every action done&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option_group</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
</pre></div>
</div>
<p>lo que da como resultado la siguiente salida:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Usage: &lt;yourscript&gt; [options] arg1 arg2

Options:
  -h, --help            show this help message and exit
  -v, --verbose         make lots of noise [default]
  -q, --quiet           be vewwy quiet (I&#39;m hunting wabbits)
  -f FILE, --filename=FILE
                        write output to FILE
  -m MODE, --mode=MODE  interaction mode: novice, intermediate, or expert
                        [default: intermediate]

  Dangerous Options:
    Caution: use these options at your own risk.  It is believed that some
    of them bite.

    -g                  Group option.

  Debug Options:
    -d, --debug         Print debug information
    -s, --sql           Print all SQL statements executed
    -e                  Print every action done
</pre></div>
</div>
<p>Otro método interesante, particularmente cuando se trabaja programáticamente con grupos de opciones, es:</p>
<dl class="py method">
<dt class="sig sig-object py" id="optparse.OptionParser.get_option_group">
<span class="sig-prename descclassname"><span class="pre">OptionParser.</span></span><span class="sig-name descname"><span class="pre">get_option_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opt_str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#optparse.OptionParser.get_option_group" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>Retorna el <a class="reference internal" href="#optparse.OptionGroup" title="optparse.OptionGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptionGroup</span></code></a> al que pertenece la cadena de opción corta o larga <em>opt_str</em> (por ejemplo, <code class="docutils literal notranslate"><span class="pre">'-o'</span></code> o <code class="docutils literal notranslate"><span class="pre">'</span> <span class="pre">--option'</span></code>). Si no existe dicho <a class="reference internal" href="#optparse.OptionGroup" title="optparse.OptionGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptionGroup</span></code></a>, el método retorna <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd></dl>

</section>
</section>
<section id="printing-a-version-string">
<span id="optparse-printing-version-string"></span><h3>Imprimir una cadena de caracteres con la versión del programa<a class="headerlink" href="#printing-a-version-string" title="Enlazar permanentemente con este título">¶</a></h3>
<p>De forma similar a lo que ocurre con la cadena de uso abreviada, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> también puede imprimir una cadena de versión para tu programa. Debes proporcionar la cadena mediante el argumento <code class="docutils literal notranslate"><span class="pre">version</span></code> de OptionParser:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="s2">&quot;%prog [-f] [-q]&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;%prog 1.0&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">%prog</span></code> se expande al igual que en <code class="docutils literal notranslate"><span class="pre">usage</span></code>. Aparte de eso, <code class="docutils literal notranslate"><span class="pre">version</span></code> puede contener cualquier cosa que desees. Cuando se proporciona, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> agrega automáticamente una opción <code class="docutils literal notranslate"><span class="pre">--version</span></code> al analizador. Si encuentra esta opción en la línea de comandos, expande la cadena <code class="docutils literal notranslate"><span class="pre">version</span></code> (reemplazando <code class="docutils literal notranslate"><span class="pre">%prog</span></code>), la imprime en la salida estándar y termina la ejecución.</p>
<p>Por ejemplo, si tu script se llama <code class="docutils literal notranslate"><span class="pre">/usr/bin/foo</span></code>:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>/usr/bin/foo --version
<span class="go">foo 1.0</span>
</pre></div>
</div>
<p>Para imprimir y obtener la cadena de caracteres <code class="docutils literal notranslate"><span class="pre">version</span></code>, se pueden utilizar cualquiera de los siguientes métodos:</p>
<dl class="py method">
<dt class="sig sig-object py" id="optparse.OptionParser.print_version">
<span class="sig-prename descclassname"><span class="pre">OptionParser.</span></span><span class="sig-name descname"><span class="pre">print_version</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#optparse.OptionParser.print_version" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>Imprime el mensaje con la versión del programa actual (<code class="docutils literal notranslate"><span class="pre">self.version</span></code>) en <em>file</em> (por defecto, la salida estándar). Al igual que con <a class="reference internal" href="#optparse.OptionParser.print_usage" title="optparse.OptionParser.print_usage"><code class="xref py py-meth docutils literal notranslate"><span class="pre">print_usage()</span></code></a>, cualquier aparición de <code class="docutils literal notranslate"><span class="pre">%prog</span></code> en <code class="docutils literal notranslate"><span class="pre">self.version</span></code> se reemplaza con el nombre del programa actual. El método no hace nada si <code class="docutils literal notranslate"><span class="pre">self.version</span></code> está vacío o no está definido.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optparse.OptionParser.get_version">
<span class="sig-prename descclassname"><span class="pre">OptionParser.</span></span><span class="sig-name descname"><span class="pre">get_version</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#optparse.OptionParser.get_version" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>Igual que <a class="reference internal" href="#optparse.OptionParser.print_version" title="optparse.OptionParser.print_version"><code class="xref py py-meth docutils literal notranslate"><span class="pre">print_version()</span></code></a>, pero retorna la cadena de versión en lugar de imprimirla.</p>
</dd></dl>

</section>
<section id="how-optparse-handles-errors">
<span id="optparse-how-optparse-handles-errors"></span><h3>Cómo maneja los errores el módulo <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a><a class="headerlink" href="#how-optparse-handles-errors" title="Enlazar permanentemente con este título">¶</a></h3>
<p>A grandes rasgos, hay dos clases de errores de los que <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> tiene que preocuparse: errores del programador y errores del usuario. Los errores del programador suelen ser el resultado de llamadas erróneas a <a class="reference internal" href="#optparse.OptionParser.add_option" title="optparse.OptionParser.add_option"><code class="xref py py-func docutils literal notranslate"><span class="pre">OptionParser.add_option()</span></code></a>, como cadenas de opción no válidas, atributos de opción desconocidos, atributos de opción que faltan, etc. Se tratan de la forma habitual: generan una excepción (ya sea <code class="xref py py-exc docutils literal notranslate"><span class="pre">optparse.OptionError</span></code> o <a class="reference internal" href="exceptions.html#TypeError" title="TypeError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">TypeError</span></code></a>) y hacen que el programa se bloquee.</p>
<p>Manejar los errores del usuario es mucho más importante, ya que está garantizado que sucederán sin importar cuán estable sea el código. <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> puede detectar automáticamente algunos errores del usuario, como argumentos de opción incorrectos (pasar <code class="docutils literal notranslate"><span class="pre">-n</span> <span class="pre">4x</span></code> donde <code class="docutils literal notranslate"><span class="pre">-n</span></code> toma un argumento entero) o la falta de argumentos (<code class="docutils literal notranslate"><span class="pre">-n</span></code> al final de la línea de comandos, donde <code class="docutils literal notranslate"><span class="pre">-n</span></code> toma un argumento de cualquier tipo). Además de esto, puedes llamar a <code class="xref py py-func docutils literal notranslate"><span class="pre">OptionParser.error()</span></code> para establecer una condición de error definida por la propia aplicación:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="o">...</span>
<span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">a</span> <span class="ow">and</span> <span class="n">options</span><span class="o">.</span><span class="n">b</span><span class="p">:</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;options -a and -b are mutually exclusive&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>En cualquier caso, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> maneja el error de la misma manera: imprime el mensaje de uso del programa junto a un mensaje de error en la salida de errores estándar y termina la ejecución con el estado de error 2.</p>
<p>Considera el primero de los dos ejemplos anteriores, donde el usuario pasa <code class="docutils literal notranslate"><span class="pre">4x</span></code> a una opción que toma un número entero:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>/usr/bin/foo -n 4x
<span class="go">Usage: foo [options]</span>

<span class="go">foo: error: option -n: invalid integer value: &#39;4x&#39;</span>
</pre></div>
</div>
<p>O, en el caso en el que el usuario definitivamente no pase ningún valor:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>/usr/bin/foo -n
<span class="go">Usage: foo [options]</span>

<span class="go">foo: error: -n option requires an argument</span>
</pre></div>
</div>
<p>Los mensajes de error generados por <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> tienen siempre cuidado de mencionar la opción involucrada en el error. Asegúrate de hacer lo mismo cuando llames a <code class="xref py py-func docutils literal notranslate"><span class="pre">OptionParser.error()</span></code> desde el código de tu aplicación.</p>
<p>Si el comportamiento del manejo de errores predeterminado de <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> no se adapta a tus necesidades, deberás subclasificar OptionParser y redefinir su método <code class="xref py py-meth docutils literal notranslate"><span class="pre">exit()</span></code> y/o <code class="xref py py-meth docutils literal notranslate"><span class="pre">error()</span></code>.</p>
</section>
<section id="putting-it-all-together">
<span id="optparse-putting-it-all-together"></span><h3>Reuniendo todas las piezas<a class="headerlink" href="#putting-it-all-together" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Así es como los scripts basados en <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> usualmente se ven:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">optparse</span> <span class="kn">import</span> <span class="n">OptionParser</span>
<span class="o">...</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">usage</span> <span class="o">=</span> <span class="s2">&quot;usage: %prog [options] arg&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">(</span><span class="n">usage</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="s2">&quot;--file&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;filename&quot;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s2">&quot;read data from FILENAME&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-v&quot;</span><span class="p">,</span> <span class="s2">&quot;--verbose&quot;</span><span class="p">,</span>
                      <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-q&quot;</span><span class="p">,</span> <span class="s2">&quot;--quiet&quot;</span><span class="p">,</span>
                      <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_false&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">)</span>
    <span class="o">...</span>
    <span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;incorrect number of arguments&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;reading </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">options</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
    <span class="o">...</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="reference-guide">
<span id="optparse-reference-guide"></span><h2>Guía de referencia<a class="headerlink" href="#reference-guide" title="Enlazar permanentemente con este título">¶</a></h2>
<section id="creating-the-parser">
<span id="optparse-creating-parser"></span><h3>Creando el analizador sintáctico (parser)<a class="headerlink" href="#creating-the-parser" title="Enlazar permanentemente con este título">¶</a></h3>
<p>El primer paso para poder usar <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> es crear una instancia de OptionParser.</p>
<dl class="py class">
<dt class="sig sig-object py" id="optparse.OptionParser">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">optparse.</span></span><span class="sig-name descname"><span class="pre">OptionParser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#optparse.OptionParser" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>El constructor de la clase OptionParser no tiene argumentos obligatorios, pero sí varios argumentos opcionales por palabra clave. Siempre deben pasarse como argumentos por palabras clave, es decir, no se debe confiar nunca en el orden en que se declaran los argumentos.</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">usage</span></code> (por defecto: <code class="docutils literal notranslate"><span class="pre">&quot;%prog</span> <span class="pre">[options]&quot;</span></code>)</dt><dd><p>El resumen de uso a imprimir cuando el programa se ejecuta incorrectamente o con una opción de ayuda. Cuando <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> imprime la cadena de uso, reemplaza <code class="docutils literal notranslate"><span class="pre">%prog</span></code> con <code class="docutils literal notranslate"><span class="pre">os.path.basename(sys.argv[0])</span></code> (o con <code class="docutils literal notranslate"><span class="pre">prog</span></code> si se proporcionó eso argumento por palabra clave). Para suprimir un mensaje de uso, se debe pasar el valor especial <code class="xref py py-data docutils literal notranslate"><span class="pre">optparse.SUPPRESS_USAGE</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">option_list</span></code> (por defecto: <code class="docutils literal notranslate"><span class="pre">[]</span></code>)</dt><dd><p>Una lista de objetos Option con los que poblar el analizador. Las opciones en <code class="docutils literal notranslate"><span class="pre">option_list</span></code> se agregan después de cualquier opción en <code class="docutils literal notranslate"><span class="pre">standard_option_list</span></code> (un atributo de clase que puede ser establecido por las subclases de OptionParser), pero antes de cualquier versión u opción de ayuda. Obsoleto: usar en su lugar el método <a class="reference internal" href="#optparse.OptionParser.add_option" title="optparse.OptionParser.add_option"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_option()</span></code></a>, una vez creado el analizador.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">option_class</span></code> (por defecto: <em>optparse.Option</em>)</dt><dd><p>Clase usada por el método <a class="reference internal" href="#optparse.OptionParser.add_option" title="optparse.OptionParser.add_option"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_option()</span></code></a> para añadir opciones al analizador.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">version</span></code> (por defecto: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</dt><dd><p>Una cadena de caracteres con la versión del programa a imprimir cuando el usuario proporciona una opción de versión. Si se proporciona un valor verdadero para <code class="docutils literal notranslate"><span class="pre">version</span></code>, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> agrega automáticamente una opción de versión con <code class="docutils literal notranslate"><span class="pre">--version</span></code> como única cadena de opción. La subcadena <code class="docutils literal notranslate"><span class="pre">%prog</span></code> se expande de la misma manera que en <code class="docutils literal notranslate"><span class="pre">usage</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">conflict_handler</span></code> (por defecto: <code class="docutils literal notranslate"><span class="pre">&quot;error&quot;</span></code>)</dt><dd><p>Especifica qué hacer cuando se agregan al analizador opciones con cadenas de opción en conflicto entre si. Ver sección <a class="reference internal" href="#optparse-conflicts-between-options"><span class="std std-ref">Conflictos entre opciones</span></a>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">description</span></code> (por defecto: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</dt><dd><p>Un párrafo de texto que ofrece una breve descripción del programa. <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> reformatea este párrafo para que se ajuste al ancho actual de la terminal y lo imprime cuando el usuario solicita ayuda (después de <code class="docutils literal notranslate"><span class="pre">usage</span></code>, pero antes de la lista de opciones).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">formatter</span></code> (por defecto: una nueva instancia de la clase <code class="xref py py-class docutils literal notranslate"><span class="pre">IndentedHelpFormatter</span></code>)</dt><dd><p>Una instancia de la clase optparse.HelpFormatter que será usada para imprimir el texto de ayuda. El módulo <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> proporciona dos clases concretas para este propósito: IndentedHelpFormatter y TitledHelpFormatter.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">add_help_option</span></code> (por defecto: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</dt><dd><p>Si es verdadero, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> agregará al analizador una opción de ayuda (con las cadenas de opción <code class="docutils literal notranslate"><span class="pre">-h</span></code> y <code class="docutils literal notranslate"><span class="pre">--help</span></code>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">prog</span></code></dt><dd><p>La cadena de caracteres a usar como substituta de <code class="docutils literal notranslate"><span class="pre">os.path.basename(sys.argv[0])</span></code> cuando se expanda <code class="docutils literal notranslate"><span class="pre">%prog</span></code> en <code class="docutils literal notranslate"><span class="pre">usage</span></code> y en <code class="docutils literal notranslate"><span class="pre">version</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">epilog</span></code> (por defecto: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</dt><dd><p>Un párrafo con texto de ayuda que se imprimirá después de la opción de ayuda.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="populating-the-parser">
<span id="optparse-populating-parser"></span><h3>Completando el analizador con opciones<a class="headerlink" href="#populating-the-parser" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Hay varias formas de agregar las opciones al analizador. La forma preferida es mediante el método <a class="reference internal" href="#optparse.OptionParser.add_option" title="optparse.OptionParser.add_option"><code class="xref py py-meth docutils literal notranslate"><span class="pre">OptionParser.add_option()</span></code></a>, tal como se muestra en la sección del <a class="reference internal" href="#optparse-tutorial"><span class="std std-ref">Tutorial</span></a>. El método <code class="xref py py-meth docutils literal notranslate"><span class="pre">add_option()</span></code> se puede llamar de dos formas diferentes:</p>
<ul class="simple">
<li><p>pasándole una instancia de Option (como la que retorna <code class="xref py py-func docutils literal notranslate"><span class="pre">make_option()</span></code>)</p></li>
<li><p>pasándole cualquier combinación de argumentos posicionales y por palabra clave que sean aceptables para <code class="xref py py-func docutils literal notranslate"><span class="pre">make_option()</span></code> (es decir, para el constructor de la clase Option), lo que creará la instancia Option automáticamente</p></li>
</ul>
<p>La otra alternativa es pasar una lista de instancias de Option previamente construidas al constructor OptionParser, como en el siguiente ejemplo:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">option_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">make_option</span><span class="p">(</span><span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="s2">&quot;--filename&quot;</span><span class="p">,</span>
                <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;filename&quot;</span><span class="p">),</span>
    <span class="n">make_option</span><span class="p">(</span><span class="s2">&quot;-q&quot;</span><span class="p">,</span> <span class="s2">&quot;--quiet&quot;</span><span class="p">,</span>
                <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_false&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">),</span>
    <span class="p">]</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">(</span><span class="n">option_list</span><span class="o">=</span><span class="n">option_list</span><span class="p">)</span>
</pre></div>
</div>
<p>(<code class="xref py py-func docutils literal notranslate"><span class="pre">make_option()</span></code> es una función fábrica para crear instancias Option. Actualmente es simplemente un alias para el constructor Option, pero es posible que una futura versión de <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> pueda dividir Option en varias clases, en cuyo caso, <code class="xref py py-func docutils literal notranslate"><span class="pre">make_option()</span></code> elegirá la clase correcta a instanciar. Esta es la razón por la que no se debe instanciar Option directamente.)</p>
</section>
<section id="defining-options">
<span id="optparse-defining-options"></span><h3>Definiendo las opciones<a class="headerlink" href="#defining-options" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Cada instancia de Option representa un conjunto de cadenas de opción sinónimas para la línea de comandos, por ejemplo <code class="docutils literal notranslate"><span class="pre">-f</span></code> y <code class="docutils literal notranslate"><span class="pre">--file</span></code>. Se puede especificar cualquier número de cadenas de opción cortas o largas, pero se debe proporcionar al menos una cadena de opción en total.</p>
<p>La forma canónica de crear una instancia de <code class="xref py py-class docutils literal notranslate"><span class="pre">Option</span></code> es mediante el método <code class="xref py py-meth docutils literal notranslate"><span class="pre">add_option()</span></code> de la clase <a class="reference internal" href="#optparse.OptionParser" title="optparse.OptionParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptionParser</span></code></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="optparse.OptionParser.add_option">
<span class="sig-prename descclassname"><span class="pre">OptionParser.</span></span><span class="sig-name descname"><span class="pre">add_option</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">option</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#optparse.OptionParser.add_option" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">OptionParser.</span></span><span class="sig-name descname"><span class="pre">add_option</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">*opt_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr=value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">...</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Para definir una opción con solo una cadena de opción corta:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>Y para definir una opción con solo una cadena de opción larga:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;--foo&quot;</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>Los argumentos por palabra clave definen atributos para el nuevo objeto Option. El atributo de opción más importante es <a class="reference internal" href="#optparse.Option.action" title="optparse.Option.action"><code class="xref py py-attr docutils literal notranslate"><span class="pre">action</span></code></a>, que determina en gran medida qué otros atributos son apropiados u obligatorios. Si se pasan atributos de opción no apropiados, o no se pasan los requeridos, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> lanza una excepción <code class="xref py py-exc docutils literal notranslate"><span class="pre">OptionError</span></code> explicando el error.</p>
<p>La acción (<em>action</em>) de una opción determina que hace el módulo <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> cuando encuentra dicha opción en la línea de comandos. Las acciones de opción estándares codificadas en <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> son:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">&quot;store&quot;</span></code></dt><dd><p>almacena el argumento de esta opción (por defecto)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;store_const&quot;</span></code></dt><dd><p>store a constant value, pre-set via <a class="reference internal" href="#optparse.Option.const" title="optparse.Option.const"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Option.const</span></code></a></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;store_true&quot;</span></code></dt><dd><p>almacena <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;store_false&quot;</span></code></dt><dd><p>almacena <code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;append&quot;</span></code></dt><dd><p>agrega el argumento de esta opción a una lista</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;append_const&quot;</span></code></dt><dd><p>append a constant value to a list, pre-set via <a class="reference internal" href="#optparse.Option.const" title="optparse.Option.const"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Option.const</span></code></a></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;count&quot;</span></code></dt><dd><p>incrementa un contador en uno</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;callback&quot;</span></code></dt><dd><p>llama a una función específica</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;help&quot;</span></code></dt><dd><p>imprime un mensaje de uso que incluye todas las opciones y la documentación correspondiente</p>
</dd>
</dl>
<p>(Si no se proporciona una acción, el valor predeterminado es <code class="docutils literal notranslate"><span class="pre">&quot;store&quot;</span></code>. Para esta acción en concreto, también se pueden proporcionar los atributos de opción <a class="reference internal" href="#optparse.Option.type" title="optparse.Option.type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">type</span></code></a> y <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a>. Consultar <a class="reference internal" href="#optparse-standard-option-actions"><span class="std std-ref">Acciones de opción estándares</span></a> para más información.)</p>
</dd></dl>

<p>Como se puede observar, la mayoría de las acciones implican almacenar o actualizar un valor en algún lugar. <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> siempre crea un objeto especial para esto, convencionalmente llamado <code class="docutils literal notranslate"><span class="pre">options</span></code> (que resulta ser una instancia de <code class="xref py py-class docutils literal notranslate"><span class="pre">optparse.Values</span></code>). Los argumentos de opción (y algunos otros valores) se almacenan como atributos de este objeto, de acuerdo con el atributo de opción <code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code> (destino) establecido.</p>
<p>Por ejemplo, cuando se llama a:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</pre></div>
</div>
<p>una de las primeras cosas que hace el módulo <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> es crear el objeto <code class="docutils literal notranslate"><span class="pre">options</span></code>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">options</span> <span class="o">=</span> <span class="n">Values</span><span class="p">()</span>
</pre></div>
</div>
<p>Si una de las opciones de este analizador es definida con:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="s2">&quot;--file&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;filename&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>y la línea de comandos que se analiza incluye cualquiera de las siguientes variantes:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">ffoo</span>
<span class="o">-</span><span class="n">f</span> <span class="n">foo</span>
<span class="o">--</span><span class="n">file</span><span class="o">=</span><span class="n">foo</span>
<span class="o">--</span><span class="n">file</span> <span class="n">foo</span>
</pre></div>
</div>
<p>entonces el módulo <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a>, al encontrar esta opción, hará algo equivalente a:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">options</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;foo&quot;</span>
</pre></div>
</div>
<p>Los atributos de opción <a class="reference internal" href="#optparse.Option.type" title="optparse.Option.type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">type</span></code></a> y <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a> son casi tan importantes como <a class="reference internal" href="#optparse.Option.action" title="optparse.Option.action"><code class="xref py py-attr docutils literal notranslate"><span class="pre">action</span></code></a>, pero <a class="reference internal" href="#optparse.Option.action" title="optparse.Option.action"><code class="xref py py-attr docutils literal notranslate"><span class="pre">action</span></code></a> es el único de ellos que es apropiado para <em>todas</em> las opciones.</p>
</section>
<section id="option-attributes">
<span id="optparse-option-attributes"></span><h3>Atributos de opción<a class="headerlink" href="#option-attributes" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Los siguientes atributos de opción pueden pasarse como argumentos por palabra clave al método <a class="reference internal" href="#optparse.OptionParser.add_option" title="optparse.OptionParser.add_option"><code class="xref py py-meth docutils literal notranslate"><span class="pre">OptionParser.add_option()</span></code></a>. Si se pasa un atributo de opción que no es apropiado para una opción en particular, o no se pasa un atributo de opción obligatorio, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> lanza una excepción <code class="xref py py-exc docutils literal notranslate"><span class="pre">OptionError</span></code>.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="optparse.Option.action">
<span class="sig-prename descclassname"><span class="pre">Option.</span></span><span class="sig-name descname"><span class="pre">action</span></span><a class="headerlink" href="#optparse.Option.action" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>(por defecto: <code class="docutils literal notranslate"><span class="pre">&quot;store&quot;</span></code>)</p>
<p>Determina el comportamiento del módulo <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> cuando esta opción se encuentra en la línea de comandos. Las opciones disponibles están documentadas <a class="reference internal" href="#optparse-standard-option-actions"><span class="std std-ref">aquí</span></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optparse.Option.type">
<span class="sig-prename descclassname"><span class="pre">Option.</span></span><span class="sig-name descname"><span class="pre">type</span></span><a class="headerlink" href="#optparse.Option.type" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>(por defecto: <code class="docutils literal notranslate"><span class="pre">&quot;string&quot;</span></code>)</p>
<p>El tipo de argumento esperado para esta opción (por ejemplo, <code class="docutils literal notranslate"><span class="pre">&quot;string&quot;</span></code> o <code class="docutils literal notranslate"><span class="pre">&quot;int&quot;</span></code>). Los tipos de opción disponibles están documentados <a class="reference internal" href="#optparse-standard-option-types"><span class="std std-ref">aquí</span></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optparse.Option.dest">
<span class="sig-prename descclassname"><span class="pre">Option.</span></span><span class="sig-name descname"><span class="pre">dest</span></span><a class="headerlink" href="#optparse.Option.dest" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>(por defecto: derivado de las cadenas de opción)</p>
<p>Si la acción asociada a la opción implica escribir o modificar un valor en algún lugar, este atributo le dice a <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> dónde escribirlo: <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a> es el nombre de un atributo del objeto <code class="docutils literal notranslate"><span class="pre">options</span></code> que <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> construye a medida que analiza la línea de comandos.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optparse.Option.default">
<span class="sig-prename descclassname"><span class="pre">Option.</span></span><span class="sig-name descname"><span class="pre">default</span></span><a class="headerlink" href="#optparse.Option.default" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>El valor que se utilizará como destino de esta opción si la opción no aparece en la línea de comandos. Ver también <a class="reference internal" href="#optparse.OptionParser.set_defaults" title="optparse.OptionParser.set_defaults"><code class="xref py py-meth docutils literal notranslate"><span class="pre">OptionParser.set_defaults()</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optparse.Option.nargs">
<span class="sig-prename descclassname"><span class="pre">Option.</span></span><span class="sig-name descname"><span class="pre">nargs</span></span><a class="headerlink" href="#optparse.Option.nargs" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>(por defecto: 1)</p>
<p>Cuántos argumentos de tipo <a class="reference internal" href="#optparse.Option.type" title="optparse.Option.type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">type</span></code></a> deben consumirse cuando se encuentre esta opción. Si es mayor a 1, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> almacenará una tupla con los valores de los argumentos en <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optparse.Option.const">
<span class="sig-prename descclassname"><span class="pre">Option.</span></span><span class="sig-name descname"><span class="pre">const</span></span><a class="headerlink" href="#optparse.Option.const" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>Para acciones que almacenan un valor constante, el valor constante a almacenar.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optparse.Option.choices">
<span class="sig-prename descclassname"><span class="pre">Option.</span></span><span class="sig-name descname"><span class="pre">choices</span></span><a class="headerlink" href="#optparse.Option.choices" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>Para opciones de tipo <code class="docutils literal notranslate"><span class="pre">&quot;choice&quot;</span></code>, la lista con las cadenas que el usuario puede elegir.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optparse.Option.callback">
<span class="sig-prename descclassname"><span class="pre">Option.</span></span><span class="sig-name descname"><span class="pre">callback</span></span><a class="headerlink" href="#optparse.Option.callback" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>Para las opciones con la acción <code class="docutils literal notranslate"><span class="pre">&quot;callback&quot;</span></code> asignada, el objeto invocable a llamar cuando se encuentra esta opción. Consultar la sección <a class="reference internal" href="#optparse-option-callbacks"><span class="std std-ref">Retrollamadas de opción</span></a> para obtener más detalles sobre los argumentos que son pasados al objeto invocable.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optparse.Option.callback_args">
<span class="sig-prename descclassname"><span class="pre">Option.</span></span><span class="sig-name descname"><span class="pre">callback_args</span></span><a class="headerlink" href="#optparse.Option.callback_args" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dt class="sig sig-object py" id="optparse.Option.callback_kwargs">
<span class="sig-prename descclassname"><span class="pre">Option.</span></span><span class="sig-name descname"><span class="pre">callback_kwargs</span></span><a class="headerlink" href="#optparse.Option.callback_kwargs" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>Argumentos posicionales y por palabra clave adicionales para ser pasados a <code class="docutils literal notranslate"><span class="pre">callback</span></code> después de los cuatro argumentos pasados a la retrollamada estándar.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optparse.Option.help">
<span class="sig-prename descclassname"><span class="pre">Option.</span></span><span class="sig-name descname"><span class="pre">help</span></span><a class="headerlink" href="#optparse.Option.help" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>Texto de ayuda a imprimir para esta opción cuando se enumeran todas las opciones disponibles, después de que el usuario proporcione una opción <a class="reference internal" href="#optparse.Option.help" title="optparse.Option.help"><code class="xref py py-attr docutils literal notranslate"><span class="pre">help</span></code></a> (como <code class="docutils literal notranslate"><span class="pre">--help</span></code>). Si no se proporciona ningún texto de ayuda, la opción seguirá apareciendo, solo que sin texto de ayuda. Para ocultar esta opción completamente, se debe asignar al atributo el valor especial <code class="xref py py-data docutils literal notranslate"><span class="pre">optparse.SUPPRESS_HELP</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optparse.Option.metavar">
<span class="sig-prename descclassname"><span class="pre">Option.</span></span><span class="sig-name descname"><span class="pre">metavar</span></span><a class="headerlink" href="#optparse.Option.metavar" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>(por defecto: derivado de las cadenas de opción)</p>
<p>Reemplazo para los argumentos de opción que se utilizará al imprimir el texto de ayuda. Consultar la sección <a class="reference internal" href="#optparse-tutorial"><span class="std std-ref">Tutorial</span></a> para ver un ejemplo.</p>
</dd></dl>

</section>
<section id="standard-option-actions">
<span id="optparse-standard-option-actions"></span><h3>Acciones de opción estándares<a class="headerlink" href="#standard-option-actions" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Las diversas acciones de opción tienen requisitos y efectos ligeramente diferentes. La mayoría de las acciones tienen varios atributos de opción relacionados que puedes especificar para dirigir el comportamiento del módulo <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a>. Además, algunas de ellas tienen atributos requeridos, que se deben especificar para cualquier opción que utilice esa acción.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;store&quot;</span></code> [atributos relacionados: <a class="reference internal" href="#optparse.Option.type" title="optparse.Option.type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">type</span></code></a>, <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a>, <a class="reference internal" href="#optparse.Option.nargs" title="optparse.Option.nargs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nargs</span></code></a>, <a class="reference internal" href="#optparse.Option.choices" title="optparse.Option.choices"><code class="xref py py-attr docutils literal notranslate"><span class="pre">choices</span></code></a>]</p>
<p>La opción debe ir seguida de un argumento, que se convierte en un valor de acuerdo a <a class="reference internal" href="#optparse.Option.type" title="optparse.Option.type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">type</span></code></a> y se almacena en <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a>. Si <a class="reference internal" href="#optparse.Option.nargs" title="optparse.Option.nargs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nargs</span></code></a> es mayor que 1, se consumirán varios argumentos de la línea de comandos. Todos ellos se convertirán de acuerdo a <a class="reference internal" href="#optparse.Option.type" title="optparse.Option.type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">type</span></code></a> y se almacenarán en <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a> como una tupla. Consultar la sección <a class="reference internal" href="#optparse-standard-option-types"><span class="std std-ref">Tipos de opción estándares</span></a> para más información.</p>
<p>Si se proporciona <a class="reference internal" href="#optparse.Option.choices" title="optparse.Option.choices"><code class="xref py py-attr docutils literal notranslate"><span class="pre">choices</span></code></a> (una lista o tupla de cadenas de caracteres), el tipo por defecto es <code class="docutils literal notranslate"><span class="pre">&quot;choice&quot;</span></code>.</p>
<p>Si no se proporciona <a class="reference internal" href="#optparse.Option.type" title="optparse.Option.type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">type</span></code></a>, el tipo por defecto es <code class="docutils literal notranslate"><span class="pre">&quot;string&quot;</span></code>.</p>
<p>Si <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a> no se proporciona, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> infiere un destino de la primera cadena de opción larga (por ejemplo, <code class="docutils literal notranslate"><span class="pre">--foo-bar</span></code> implica que se usará <code class="docutils literal notranslate"><span class="pre">foo_bar</span></code> como destino). Si no hay cadenas de opción largas, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> obtiene el destino a partir de la primera cadena de opción corta (por ejemplo, <code class="docutils literal notranslate"><span class="pre">-f</span></code> conlleva que se usará <code class="docutils literal notranslate"><span class="pre">f</span></code>).</p>
<p>Ejemplo:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-f&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-p&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;point&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Mientras analiza la línea de comandos:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">f</span> <span class="n">foo</span><span class="o">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">p</span> <span class="mi">1</span> <span class="o">-</span><span class="mf">3.5</span> <span class="mi">4</span> <span class="o">-</span><span class="n">fbar</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p><a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> establecerá:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">options</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="s2">&quot;foo.txt&quot;</span>
<span class="n">options</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span>
<span class="n">options</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="s2">&quot;bar.txt&quot;</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;store_const&quot;</span></code> [atributo requerido: <a class="reference internal" href="#optparse.Option.const" title="optparse.Option.const"><code class="xref py py-attr docutils literal notranslate"><span class="pre">const</span></code></a>; atributo relacionado: <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a>]</p>
<p>El valor <a class="reference internal" href="#optparse.Option.const" title="optparse.Option.const"><code class="xref py py-attr docutils literal notranslate"><span class="pre">const</span></code></a> es almacenado en <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a>.</p>
<p>Ejemplo:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-q&quot;</span><span class="p">,</span> <span class="s2">&quot;--quiet&quot;</span><span class="p">,</span>
                  <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_const&quot;</span><span class="p">,</span> <span class="n">const</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-v&quot;</span><span class="p">,</span> <span class="s2">&quot;--verbose&quot;</span><span class="p">,</span>
                  <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_const&quot;</span><span class="p">,</span> <span class="n">const</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;--noisy&quot;</span><span class="p">,</span>
                  <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_const&quot;</span><span class="p">,</span> <span class="n">const</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Si se encuentra <code class="docutils literal notranslate"><span class="pre">--noisy</span></code>, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> establecerá:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">options</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;store_true&quot;</span></code> [atributo relacionado: <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a>]</p>
<p>Un caso especial de <code class="docutils literal notranslate"><span class="pre">&quot;store_const&quot;</span></code> que almacena <code class="docutils literal notranslate"><span class="pre">True</span></code> en <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a>.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;store_false&quot;</span></code> [atributo relacionado: <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a>]</p>
<p>Como <code class="docutils literal notranslate"><span class="pre">&quot;store_true&quot;</span></code>, pero almacena <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>Ejemplo:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;--clobber&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;clobber&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;--no-clobber&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_false&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;clobber&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;append&quot;</span></code> [atributos relacionados: <a class="reference internal" href="#optparse.Option.type" title="optparse.Option.type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">type</span></code></a>, <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a>, <a class="reference internal" href="#optparse.Option.nargs" title="optparse.Option.nargs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nargs</span></code></a>, <a class="reference internal" href="#optparse.Option.choices" title="optparse.Option.choices"><code class="xref py py-attr docutils literal notranslate"><span class="pre">choices</span></code></a>]</p>
<p>La opción debe ir seguida de un argumento, que se añade a la lista de <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a>. Si no se proporciona un valor predeterminado para <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a>, se crea automáticamente una lista vacía cuando <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> encuentra por primera vez esta opción en la línea de comandos. Si <a class="reference internal" href="#optparse.Option.nargs" title="optparse.Option.nargs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nargs</span></code></a> es mayor que 1, se consumen varios argumentos y se agrega una tupla de longitud <a class="reference internal" href="#optparse.Option.nargs" title="optparse.Option.nargs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nargs</span></code></a> a <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a>.</p>
<p>Los valores por defecto para los atributos <a class="reference internal" href="#optparse.Option.type" title="optparse.Option.type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">type</span></code></a> y <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a> son los mismos que para la acción <code class="docutils literal notranslate"><span class="pre">&quot;store&quot;</span></code>.</p>
<p>Ejemplo:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-t&quot;</span><span class="p">,</span> <span class="s2">&quot;--tracks&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;append&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Si se encuentra <code class="docutils literal notranslate"><span class="pre">-t3</span></code> en la línea de comandos, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> procede de forma equivalente a:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">options</span><span class="o">.</span><span class="n">tracks</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">options</span><span class="o">.</span><span class="n">tracks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="s2">&quot;3&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>Si, un poco más adelante, se encuentra <code class="docutils literal notranslate"><span class="pre">--tracks=4</span></code>, procede así:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">options</span><span class="o">.</span><span class="n">tracks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="s2">&quot;4&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>La acción <code class="docutils literal notranslate"><span class="pre">append</span></code> llama al método <code class="docutils literal notranslate"><span class="pre">append</span></code> con el valor actual de la opción. Esto significa que cualquier valor por defecto especificado debe tener un método <code class="docutils literal notranslate"><span class="pre">append</span></code>. También significa que si existe un valor por defecto, los elementos por defecto estarán presentes en el valor analizado para la opción, con todos los valores de la línea de comandos agregados a la lista a continuación de ellos:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;--files&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;append&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;~/.mypkg/defaults&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opts</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">([</span><span class="s1">&#39;--files&#39;</span><span class="p">,</span> <span class="s1">&#39;overrides.mypkg&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opts</span><span class="o">.</span><span class="n">files</span>
<span class="go">[&#39;~/.mypkg/defaults&#39;, &#39;overrides.mypkg&#39;]</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;append_const&quot;</span></code> [atributo requerido: <a class="reference internal" href="#optparse.Option.const" title="optparse.Option.const"><code class="xref py py-attr docutils literal notranslate"><span class="pre">const</span></code></a>; atributo relacionado: <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a>]</p>
<p>Igual que <code class="docutils literal notranslate"><span class="pre">&quot;store_const&quot;</span></code>, pero el valor <a class="reference internal" href="#optparse.Option.const" title="optparse.Option.const"><code class="xref py py-attr docutils literal notranslate"><span class="pre">const</span></code></a> se agrega a <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a>. Como ocurre con <code class="docutils literal notranslate"><span class="pre">&quot;append&quot;</span></code>, <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a> por defecto es <code class="docutils literal notranslate"><span class="pre">None</span></code> y se crea automáticamente una lista vacía la primera vez que se encuentra la opción en la linea de comandos.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;count&quot;</span></code> [atributo relacionado: <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a>]</p>
<p>Incrementa el entero almacenado en <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a>. Si no se proporciona un valor por defecto, <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a> se establece en cero antes de incrementarse por primera vez.</p>
<p>Ejemplo:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-v&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;verbosity&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>La primera vez que se encuentra <code class="docutils literal notranslate"><span class="pre">-v</span></code> en la línea de comandos, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> procede de forma equivalente a:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">options</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">options</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>Cada aparición posterior de <code class="docutils literal notranslate"><span class="pre">-v</span></code> da como resultado:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">options</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;callback&quot;</span></code> [atributo requerido: <a class="reference internal" href="#optparse.Option.callback" title="optparse.Option.callback"><code class="xref py py-attr docutils literal notranslate"><span class="pre">callback</span></code></a>; atributos relacionados: <a class="reference internal" href="#optparse.Option.type" title="optparse.Option.type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">type</span></code></a>, <a class="reference internal" href="#optparse.Option.nargs" title="optparse.Option.nargs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nargs</span></code></a>, <a class="reference internal" href="#optparse.Option.callback_args" title="optparse.Option.callback_args"><code class="xref py py-attr docutils literal notranslate"><span class="pre">callback_args</span></code></a>, <a class="reference internal" href="#optparse.Option.callback_kwargs" title="optparse.Option.callback_kwargs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">callback_kwargs</span></code></a>]</p>
<p>Llama a la función especificada por <a class="reference internal" href="#optparse.Option.callback" title="optparse.Option.callback"><code class="xref py py-attr docutils literal notranslate"><span class="pre">callback</span></code></a>, que es llamada como:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">func</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">opt_str</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">parser</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>Ver sección <a class="reference internal" href="#optparse-option-callbacks"><span class="std std-ref">Retrollamadas de opción</span></a> para más detalles.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;help&quot;</span></code></p>
<p>Imprime un mensaje de ayuda completo para todas las opciones presentes en el analizador de opciones actual. El mensaje de ayuda se construye a partir de la cadena <code class="docutils literal notranslate"><span class="pre">usage</span></code>, pasada al constructor de OptionParser, y la cadena <a class="reference internal" href="#optparse.Option.help" title="optparse.Option.help"><code class="xref py py-attr docutils literal notranslate"><span class="pre">help</span></code></a>, pasada a cada opción.</p>
<p>Si no se proporciona una cadena <a class="reference internal" href="#optparse.Option.help" title="optparse.Option.help"><code class="xref py py-attr docutils literal notranslate"><span class="pre">help</span></code></a> para una opción, dicha opción seguirá apareciendo en el mensaje de ayuda. Para omitir una opción por completo, debe usarse el valor especial <code class="xref py py-data docutils literal notranslate"><span class="pre">optparse.SUPPRESS_HELP</span></code>.</p>
<p>El módulo <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> agrega automáticamente una opción <a class="reference internal" href="#optparse.Option.help" title="optparse.Option.help"><code class="xref py py-attr docutils literal notranslate"><span class="pre">help</span></code></a> a todos los OptionParsers, por lo que normalmente no es necesario crear una.</p>
<p>Ejemplo:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">optparse</span> <span class="kn">import</span> <span class="n">OptionParser</span><span class="p">,</span> <span class="n">SUPPRESS_HELP</span>

<span class="c1"># usually, a help option is added automatically, but that can</span>
<span class="c1"># be suppressed using the add_help_option argument</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">(</span><span class="n">add_help_option</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-h&quot;</span><span class="p">,</span> <span class="s2">&quot;--help&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;help&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-v&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span>
                  <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Be moderately verbose&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;--file&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;filename&quot;</span><span class="p">,</span>
                  <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Input file to read data from&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;--secret&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="n">SUPPRESS_HELP</span><span class="p">)</span>
</pre></div>
</div>
<p>Si <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> encuentra <code class="docutils literal notranslate"><span class="pre">-h</span></code> o <code class="docutils literal notranslate"><span class="pre">--help</span></code> en la línea de comandos, imprimirá un mensaje de ayuda en la salida estándar como el siguiente (asumiendo que <code class="docutils literal notranslate"><span class="pre">sys.argv</span> <span class="pre">[0]</span></code> es <code class="docutils literal notranslate"><span class="pre">&quot;foo.py&quot;</span></code>):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Usage: foo.py [options]

Options:
  -h, --help        Show this help message and exit
  -v                Be moderately verbose
  --file=FILENAME   Input file to read data from
</pre></div>
</div>
<p>Después de imprimir el mensaje de ayuda, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> termina su proceso con <code class="docutils literal notranslate"><span class="pre">sys.exit(0)</span></code>.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;version&quot;</span></code></p>
<p>Imprime el número de versión proporcionado a OptionParser en la salida estándar y termina la ejecución. El número de versión en realidad es formateado e impreso por el método <code class="docutils literal notranslate"><span class="pre">print_version()</span></code> de OptionParser. Generalmente solo es relevante si el argumento <code class="docutils literal notranslate"><span class="pre">version</span></code> se proporciona al constructor de OptionParser. Al igual que en el caso de las opciones <a class="reference internal" href="#optparse.Option.help" title="optparse.Option.help"><code class="xref py py-attr docutils literal notranslate"><span class="pre">help</span></code></a>, rara vez será necesario crear opciones de <code class="docutils literal notranslate"><span class="pre">version</span></code>, ya que <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> las agrega automáticamente cuando es necesario.</p>
</li>
</ul>
</section>
<section id="standard-option-types">
<span id="optparse-standard-option-types"></span><h3>Tipos de opción estándares<a class="headerlink" href="#standard-option-types" title="Enlazar permanentemente con este título">¶</a></h3>
<p>El módulo <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> proporciona cinco tipos de opción incorporados: <code class="docutils literal notranslate"><span class="pre">&quot;string&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;int&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;choice&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;float&quot;</span></code> y <code class="docutils literal notranslate"><span class="pre">&quot;complex&quot;</span></code>. Consultar la sección <a class="reference internal" href="#optparse-extending-optparse"><span class="std std-ref">Extendiendo el módulo optparse</span></a> si se necesitan agregar nuevos tipos de opción.</p>
<p>Los argumentos de las opciones en la cadena ingresada no se verifican ni se convierten de ninguna manera: el texto de la línea de comandos se almacena en el destino (o se pasa a la retrollamada) tal cual.</p>
<p>Los argumentos enteros (tipo <code class="docutils literal notranslate"><span class="pre">&quot;int&quot;</span></code>) se analizan de la siguiente manera:</p>
<ul class="simple">
<li><p>si el número comienza con <code class="docutils literal notranslate"><span class="pre">0x</span></code>, se analiza como un número hexadecimal</p></li>
<li><p>si el número comienza con <code class="docutils literal notranslate"><span class="pre">0</span></code>, se analiza como un número octal</p></li>
<li><p>si el número comienza con <code class="docutils literal notranslate"><span class="pre">0b</span></code>, se analiza como un número binario</p></li>
<li><p>en cualquier otro caso, el número se analiza como un número decimal</p></li>
</ul>
<p>La conversión se realiza llamando a <a class="reference internal" href="functions.html#int" title="int"><code class="xref py py-func docutils literal notranslate"><span class="pre">int()</span></code></a> con la base apropiada (2, 8, 10 o 16). Si esto falla, también lo hará <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a>, aunque mostrando un mensaje de error más útil para el usuario.</p>
<p>Los argumentos de las opciones de tipo <code class="docutils literal notranslate"><span class="pre">&quot;float&quot;</span></code> y <code class="docutils literal notranslate"><span class="pre">&quot;complex&quot;</span></code> se convierten directamente usando <a class="reference internal" href="functions.html#float" title="float"><code class="xref py py-func docutils literal notranslate"><span class="pre">float()</span></code></a> y <a class="reference internal" href="functions.html#complex" title="complex"><code class="xref py py-func docutils literal notranslate"><span class="pre">complex()</span></code></a> respectivamente, con un manejo de errores similar.</p>
<p>Las opciones de tipo <code class="docutils literal notranslate"><span class="pre">&quot;choice&quot;</span></code> son un subtipo de las opciones <code class="docutils literal notranslate"><span class="pre">&quot;string&quot;</span></code>. El atributo de opción <a class="reference internal" href="#optparse.Option.choices" title="optparse.Option.choices"><code class="xref py py-attr docutils literal notranslate"><span class="pre">choices</span></code></a> (que es una secuencia de cadenas) define el conjunto de argumentos de opción permitidos. Posteriormente, <code class="xref py py-func docutils literal notranslate"><span class="pre">optparse.check_choice()</span></code> comparará los argumentos de las opciones proporcionadas por el usuario con esta lista maestra y lanzará una excepción <code class="xref py py-exc docutils literal notranslate"><span class="pre">OptionValueError</span></code> si se proporciona una cadena no válida.</p>
</section>
<section id="parsing-arguments">
<span id="optparse-parsing-arguments"></span><h3>Analizando los argumentos<a class="headerlink" href="#parsing-arguments" title="Enlazar permanentemente con este título">¶</a></h3>
<p>El objetivo primario de crear y agregar opciones a un OptionParser es llamar a su método <code class="xref py py-meth docutils literal notranslate"><span class="pre">parse_args()</span></code>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>donde los parámetros de entrada son</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">args</span></code></dt><dd><p>la lista de argumentos a procesar (por defecto: <code class="docutils literal notranslate"><span class="pre">sys.argv</span> <span class="pre">[1:]</span></code>)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">values</span></code></dt><dd><p>un objeto de la clase <code class="xref py py-class docutils literal notranslate"><span class="pre">optparse.Values</span></code> para almacenar en él los argumentos de las opciones. Por defecto es una nueva instancia de la clase <code class="xref py py-class docutils literal notranslate"><span class="pre">Values</span></code>. Si se proporciona un objeto previamente creado, los valores predeterminados de la opción no se inicializarán en el mismo</p>
</dd>
</dl>
<p>y los valores de retorno son</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">options</span></code></dt><dd><p>el mismo objeto que se pasó como <code class="docutils literal notranslate"><span class="pre">values</span></code>, o la instancia <em>optparse.Values</em> creada por <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">args</span></code></dt><dd><p>los argumentos posicionales que quedan en la linea de comandos después de que se hayan procesado todas las opciones</p>
</dd>
</dl>
<p>El uso más habitual es no proporcionar ningún argumento por palabra clave. Si se proporciona <code class="docutils literal notranslate"><span class="pre">values</span></code>, dicho argumento será modificado mediante llamadas repetidas a <a class="reference internal" href="functions.html#setattr" title="setattr"><code class="xref py py-func docutils literal notranslate"><span class="pre">setattr()</span></code></a> (aproximadamente una por cada argumento de opción a almacenar en un destino de opción) y finalmente será retornado por el método <code class="xref py py-meth docutils literal notranslate"><span class="pre">parse_args()</span></code>.</p>
<p>Si el método <code class="xref py py-meth docutils literal notranslate"><span class="pre">parse_args()</span></code> encuentra algún error en la lista de argumentos, llama al método <code class="xref py py-meth docutils literal notranslate"><span class="pre">error()</span></code> de OptionParser con un mensaje de error apropiado para el usuario final. Esto causa que el proceso termine con un estado de salida de 2 (el estado de salida tradicional en Unix para errores en la línea de comandos).</p>
</section>
<section id="querying-and-manipulating-your-option-parser">
<span id="optparse-querying-manipulating-option-parser"></span><h3>Consultar y manipular el analizador de opciones<a class="headerlink" href="#querying-and-manipulating-your-option-parser" title="Enlazar permanentemente con este título">¶</a></h3>
<p>El comportamiento predeterminado del analizador de opciones se puede personalizar ligeramente. También se puede indagar en el analizador de opciones y ver qué hay en él. OptionParser proporciona varios métodos para ayudar con éstos propósitos:</p>
<dl class="py method">
<dt class="sig sig-object py" id="optparse.OptionParser.disable_interspersed_args">
<span class="sig-prename descclassname"><span class="pre">OptionParser.</span></span><span class="sig-name descname"><span class="pre">disable_interspersed_args</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#optparse.OptionParser.disable_interspersed_args" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>Configura el análisis para que se detenga en lo primero que encuentre que no sea una opción. Por ejemplo, si <code class="docutils literal notranslate"><span class="pre">-a</span></code> y <code class="docutils literal notranslate"><span class="pre">-b</span></code> son opciones simples que no toman argumentos, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> normalmente acepta esta sintaxis:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">prog</span> <span class="o">-</span><span class="n">a</span> <span class="n">arg1</span> <span class="o">-</span><span class="n">b</span> <span class="n">arg2</span>
</pre></div>
</div>
<p>y la trata de forma equivalente a:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">prog</span> <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">b</span> <span class="n">arg1</span> <span class="n">arg2</span>
</pre></div>
</div>
<p>Para deshabilitar esta funcionalidad, se debe llamar al método <a class="reference internal" href="#optparse.OptionParser.disable_interspersed_args" title="optparse.OptionParser.disable_interspersed_args"><code class="xref py py-meth docutils literal notranslate"><span class="pre">disable_interspersed_args()</span></code></a>. Esto restaura la sintaxis tradicional usada en Unix, donde el análisis de opción se detiene con el primer argumento que no es una opción.</p>
<p>Se debe usar este método si se dispone de un procesador de comandos que ejecuta otro comando con sus propias opciones y se desea asegurarse de que estas opciones no se confunden entre si. Lo que puede ocurrir si, por ejemplo, cada comando tiene un conjunto diferente de opciones.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optparse.OptionParser.enable_interspersed_args">
<span class="sig-prename descclassname"><span class="pre">OptionParser.</span></span><span class="sig-name descname"><span class="pre">enable_interspersed_args</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#optparse.OptionParser.enable_interspersed_args" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>Configura el análisis para que no se detenga si encuentra un argumento que no sea una opción, lo que permite intercalar modificadores con argumentos de linea de comandos. Este es el comportamiento por defecto.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optparse.OptionParser.get_option">
<span class="sig-prename descclassname"><span class="pre">OptionParser.</span></span><span class="sig-name descname"><span class="pre">get_option</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opt_str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#optparse.OptionParser.get_option" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>Retorna la instancia de Option con la cadena de opción <em>opt_str</em>, o <code class="docutils literal notranslate"><span class="pre">None</span></code> si ninguna opción tiene esa cadena de opción.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optparse.OptionParser.has_option">
<span class="sig-prename descclassname"><span class="pre">OptionParser.</span></span><span class="sig-name descname"><span class="pre">has_option</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opt_str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#optparse.OptionParser.has_option" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>Retorna <code class="docutils literal notranslate"><span class="pre">True</span></code> si OptionParser tiene una opción con la cadena de opción <em>opt_str</em> (por ejemplo, <code class="docutils literal notranslate"><span class="pre">-q</span></code> o <code class="docutils literal notranslate"><span class="pre">--verbose</span></code>).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optparse.OptionParser.remove_option">
<span class="sig-prename descclassname"><span class="pre">OptionParser.</span></span><span class="sig-name descname"><span class="pre">remove_option</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opt_str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#optparse.OptionParser.remove_option" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>Si <a class="reference internal" href="#optparse.OptionParser" title="optparse.OptionParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptionParser</span></code></a> tiene una opción correspondiente a <em>opt_str</em>, esa opción es eliminada. Si esa opción proporcionó cualquier otra cadena de opción, todas esas cadenas de opción quedan invalidadas. Si <em>opt_str</em> no aparece en ninguna opción que pertenezca a este <a class="reference internal" href="#optparse.OptionParser" title="optparse.OptionParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptionParser</span></code></a>, se lanza una excepción <a class="reference internal" href="exceptions.html#ValueError" title="ValueError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a>.</p>
</dd></dl>

</section>
<section id="conflicts-between-options">
<span id="optparse-conflicts-between-options"></span><h3>Conflictos entre opciones<a class="headerlink" href="#conflicts-between-options" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Si no se tiene cuidado, es fácil definir opciones con cadenas de opción en conflicto entre si:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-n&quot;</span><span class="p">,</span> <span class="s2">&quot;--dry-run&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-n&quot;</span><span class="p">,</span> <span class="s2">&quot;--noisy&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>(Esto es particularmente cierto si se ha definido una subclase propia de OptionParser con algunas opciones estándar.)</p>
<p>Cada vez que se agrega una opción, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> comprueba si existen conflictos con las opciones ya existentes. Si encuentra alguno, invoca el mecanismo de manejo de conflictos actualmente establecido. Se puede establecer el mecanismo de manejo de conflictos desde el propio constructor:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">conflict_handler</span><span class="o">=</span><span class="n">handler</span><span class="p">)</span>
</pre></div>
</div>
<p>o mediante una llamada separada:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">set_conflict_handler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
</pre></div>
</div>
<p>Los administradores de conflictos disponibles son:</p>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">&quot;error&quot;</span></code> (por defecto)</dt><dd><p>se asume que los conflictos entre opciones son un error de programación y, por tanto, generarán una excepción <code class="xref py py-exc docutils literal notranslate"><span class="pre">OptionConflictError</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;resolve&quot;</span></code></dt><dd><p>resuelve conflictos de opciones de forma inteligente (ver más abajo)</p>
</dd>
</dl>
</div></blockquote>
<p>Como ejemplo, vamos a definir un <a class="reference internal" href="#optparse.OptionParser" title="optparse.OptionParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptionParser</span></code></a> que resuelva conflictos de manera inteligente y agregaremos algunas opciones conflictivas:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">(</span><span class="n">conflict_handler</span><span class="o">=</span><span class="s2">&quot;resolve&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-n&quot;</span><span class="p">,</span> <span class="s2">&quot;--dry-run&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;do no harm&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-n&quot;</span><span class="p">,</span> <span class="s2">&quot;--noisy&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;be noisy&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>At this point, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> detects that a previously added option is already
using the <code class="docutils literal notranslate"><span class="pre">-n</span></code> option string.  Since <code class="docutils literal notranslate"><span class="pre">conflict_handler</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;resolve&quot;</span></code>,
it resolves the situation by removing <code class="docutils literal notranslate"><span class="pre">-n</span></code> from the earlier option’s list of
option strings.  Now <code class="docutils literal notranslate"><span class="pre">--dry-run</span></code> is the only way for the user to activate
that option.  If the user asks for help, the help message will reflect that:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">Options</span><span class="p">:</span>
  <span class="o">--</span><span class="n">dry</span><span class="o">-</span><span class="n">run</span>     <span class="n">do</span> <span class="n">no</span> <span class="n">harm</span>
  <span class="o">...</span>
  <span class="o">-</span><span class="n">n</span><span class="p">,</span> <span class="o">--</span><span class="n">noisy</span>   <span class="n">be</span> <span class="n">noisy</span>
</pre></div>
</div>
<p>It’s possible to whittle away the option strings for a previously added option
until there are none left, and the user has no way of invoking that option from
the command-line.  In that case, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> removes that option completely,
so it doesn’t show up in help text or anywhere else. Carrying on with our
existing OptionParser:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;--dry-run&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;new dry-run option&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>En este punto, la opción original <code class="docutils literal notranslate"><span class="pre">-n</span></code>/<code class="docutils literal notranslate"><span class="pre">--dry-run</span></code> ya no es accesible, por lo que <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> la elimina, dejando el siguiente texto de ayuda:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">Options</span><span class="p">:</span>
  <span class="o">...</span>
  <span class="o">-</span><span class="n">n</span><span class="p">,</span> <span class="o">--</span><span class="n">noisy</span>   <span class="n">be</span> <span class="n">noisy</span>
  <span class="o">--</span><span class="n">dry</span><span class="o">-</span><span class="n">run</span>     <span class="n">new</span> <span class="n">dry</span><span class="o">-</span><span class="n">run</span> <span class="n">option</span>
</pre></div>
</div>
</section>
<section id="cleanup">
<span id="optparse-cleanup"></span><h3>Limpieza<a class="headerlink" href="#cleanup" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Las instancias de OptionParser tienen varias referencias cíclicas. Esto no debería ser un problema para el recolector de basura de Python, pero es posible que se desee romper las referencias cíclicas explícitamente llamando al método <code class="xref py py-meth docutils literal notranslate"><span class="pre">destroy()</span></code> de la instancia OptionParser una vez que se haya terminado. Esto es particularmente útil en aplicaciones de larga ejecución en las que OptionParser puede terminar accediendo a grafos de objetos considerablemente grandes.</p>
</section>
<section id="other-methods">
<span id="optparse-other-methods"></span><h3>Otros métodos<a class="headerlink" href="#other-methods" title="Enlazar permanentemente con este título">¶</a></h3>
<p>OptionParser admite varios métodos públicos más:</p>
<dl class="py method">
<dt class="sig sig-object py" id="optparse.OptionParser.set_usage">
<span class="sig-prename descclassname"><span class="pre">OptionParser.</span></span><span class="sig-name descname"><span class="pre">set_usage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">usage</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#optparse.OptionParser.set_usage" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>Establece la cadena de caracteres de uso de acuerdo a las reglas descritas anteriormente para el argumento por palabra clave <code class="docutils literal notranslate"><span class="pre">usage</span></code> del constructor. Si se pasa <code class="docutils literal notranslate"><span class="pre">None</span></code> se establece la cadena de uso por defecto. Para suprimir el mensaje de uso totalmente, se debe pasar el valor especial <code class="xref py py-data docutils literal notranslate"><span class="pre">optparse.SUPPRESS_USAGE</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optparse.OptionParser.print_usage">
<span class="sig-prename descclassname"><span class="pre">OptionParser.</span></span><span class="sig-name descname"><span class="pre">print_usage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#optparse.OptionParser.print_usage" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>Imprime el mensaje de uso del programa actual (<code class="docutils literal notranslate"><span class="pre">self.usage</span></code>) en <em>file</em> (que por defecto es la salida estándar). Cualquier aparición de la cadena de caracteres <code class="docutils literal notranslate"><span class="pre">%prog</span></code> en <code class="docutils literal notranslate"><span class="pre">self.usage</span></code> es reemplazada con el nombre del programa actual. No hace nada si <code class="docutils literal notranslate"><span class="pre">self.usage</span></code> está vacío o no ha sido definido.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optparse.OptionParser.get_usage">
<span class="sig-prename descclassname"><span class="pre">OptionParser.</span></span><span class="sig-name descname"><span class="pre">get_usage</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#optparse.OptionParser.get_usage" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>Igual que <a class="reference internal" href="#optparse.OptionParser.print_usage" title="optparse.OptionParser.print_usage"><code class="xref py py-meth docutils literal notranslate"><span class="pre">print_usage()</span></code></a> pero retorna la cadena de uso en vez de imprimirla.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optparse.OptionParser.set_defaults">
<span class="sig-prename descclassname"><span class="pre">OptionParser.</span></span><span class="sig-name descname"><span class="pre">set_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dest=value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#optparse.OptionParser.set_defaults" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>Establece valores por defecto para varios destinos de opción a la vez. Usar el método <a class="reference internal" href="#optparse.OptionParser.set_defaults" title="optparse.OptionParser.set_defaults"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_defaults()</span></code></a> es la forma preferida de establecer valores por defecto para las opciones, ya que varias opciones pueden compartir el mismo destino. Por ejemplo, si varias opciones de <code class="docutils literal notranslate"><span class="pre">mode</span></code> tienen el mismo destino, cualquiera de ellas puede establecer el valor por defecto, pero el último establecido es el que finalmente queda establecido:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;--advanced&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_const&quot;</span><span class="p">,</span>
                  <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="n">const</span><span class="o">=</span><span class="s2">&quot;advanced&quot;</span><span class="p">,</span>
                  <span class="n">default</span><span class="o">=</span><span class="s2">&quot;novice&quot;</span><span class="p">)</span>    <span class="c1"># overridden below</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;--novice&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_const&quot;</span><span class="p">,</span>
                  <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="n">const</span><span class="o">=</span><span class="s2">&quot;novice&quot;</span><span class="p">,</span>
                  <span class="n">default</span><span class="o">=</span><span class="s2">&quot;advanced&quot;</span><span class="p">)</span>  <span class="c1"># overrides above setting</span>
</pre></div>
</div>
<p>Para evitar esta confusión, usa el método <a class="reference internal" href="#optparse.OptionParser.set_defaults" title="optparse.OptionParser.set_defaults"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_defaults()</span></code></a>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;advanced&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;--advanced&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_const&quot;</span><span class="p">,</span>
                  <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="n">const</span><span class="o">=</span><span class="s2">&quot;advanced&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;--novice&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_const&quot;</span><span class="p">,</span>
                  <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="n">const</span><span class="o">=</span><span class="s2">&quot;novice&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
<section id="option-callbacks">
<span id="optparse-option-callbacks"></span><h2>Retrollamadas de opción<a class="headerlink" href="#option-callbacks" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Cuando las acciones y tipos incorporados de <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> no son suficientes para tus necesidades, tienes dos opciones: extender <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> o definir una opción con una retrollamada asociada. Extender <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> es más general, pero algo exagerado para muchos casos simples. Es frecuente que una simple retrollamada sea todo lo que necesitas.</p>
<p>Hay dos pasos a seguir para definir una opción con retrollamada:</p>
<ul class="simple">
<li><p>definir la opción en sí usando la acción <code class="docutils literal notranslate"><span class="pre">&quot;callback&quot;</span></code></p></li>
<li><p>escribir la retrollamada. Esta es una función (o método) que toma al menos cuatro argumentos, los cuales son descritos a continuación</p></li>
</ul>
<section id="defining-a-callback-option">
<span id="optparse-defining-callback-option"></span><h3>Definición de una opción con retrollamada<a class="headerlink" href="#defining-a-callback-option" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Generalmente, la forma más sencilla de definir una opción con retrollamada es mediante el método <a class="reference internal" href="#optparse.OptionParser.add_option" title="optparse.OptionParser.add_option"><code class="xref py py-meth docutils literal notranslate"><span class="pre">OptionParser.add_option()</span></code></a>. Aparte de <a class="reference internal" href="#optparse.Option.action" title="optparse.Option.action"><code class="xref py py-attr docutils literal notranslate"><span class="pre">action</span></code></a>, el único atributo de opción que debes especificar es <code class="docutils literal notranslate"><span class="pre">callback</span></code>, que es la función a llamar:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;callback&quot;</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">my_callback</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">callback</span></code> es una función (u otro objeto invocable), lo que implica que <code class="docutils literal notranslate"><span class="pre">my_callback()</span></code> debe haber sido definida antes de la la creación de esta opción con retrollamada. En este caso simple, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> ni siquiera sabe si <code class="docutils literal notranslate"><span class="pre">-c</span></code> toma algún argumento, lo que generalmente significa que la opción no toma argumentos—la mera presencia de <code class="docutils literal notranslate"><span class="pre">-c</span></code> en la línea de comandos es todo lo que necesita saber. Sin embargo, en algunas circunstancias, es posible que se desee que la retrollamada consuma una cantidad arbitraria de argumentos de la propia línea de comandos. Es aquí donde escribir retrollamadas se vuelve complicado; se tratará más adelante en esta sección.</p>
<p><a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> siempre pasa cuatro argumentos concretos a la retrollamada. El método solo pasará argumentos adicionales si se especifica explícitamente a través de <a class="reference internal" href="#optparse.Option.callback_args" title="optparse.Option.callback_args"><code class="xref py py-attr docutils literal notranslate"><span class="pre">callback_args</span></code></a> y <a class="reference internal" href="#optparse.Option.callback_kwargs" title="optparse.Option.callback_kwargs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">callback_kwargs</span></code></a>. Por lo tanto, la firma mínima de la retrollamada es:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_callback</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
</pre></div>
</div>
<p>Los cuatro argumentos para la retrollamada se describen a continuación.</p>
<p>Hay varios atributos de opción adicionales que se pueden proporcionar cuando se define una opción con retrollamada:</p>
<dl class="simple">
<dt><a class="reference internal" href="#optparse.Option.type" title="optparse.Option.type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">type</span></code></a></dt><dd><p>tiene su significado habitual: al igual que en las acciones <code class="docutils literal notranslate"><span class="pre">&quot;store&quot;</span></code> o <code class="docutils literal notranslate"><span class="pre">&quot;append&quot;</span></code>, indica a <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> que debe consumir un argumento y convertirlo a <a class="reference internal" href="#optparse.Option.type" title="optparse.Option.type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">type</span></code></a> . Sin embargo, en lugar de almacenar el valor (o valores) convertido en algún lugar, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> lo pasa a la retrollamada.</p>
</dd>
<dt><a class="reference internal" href="#optparse.Option.nargs" title="optparse.Option.nargs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nargs</span></code></a></dt><dd><p>también tiene su significado habitual: si se proporciona y es mayor que 1, <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> consumirá <a class="reference internal" href="#optparse.Option.nargs" title="optparse.Option.nargs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nargs</span></code></a> argumentos de la línea de comandos, cada uno de los cuales debe ser convertible a <a class="reference internal" href="#optparse.Option.type" title="optparse.Option.type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">type</span></code></a>. Hecho esto, se pasa una tupla con los valores convertidos a la retrollamada.</p>
</dd>
<dt><a class="reference internal" href="#optparse.Option.callback_args" title="optparse.Option.callback_args"><code class="xref py py-attr docutils literal notranslate"><span class="pre">callback_args</span></code></a></dt><dd><p>una tupla con los argumentos posicionales adicionales para pasar a la retrollamada</p>
</dd>
<dt><a class="reference internal" href="#optparse.Option.callback_kwargs" title="optparse.Option.callback_kwargs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">callback_kwargs</span></code></a></dt><dd><p>un diccionario con los argumentos por palabra clave para pasar a la retrollamada</p>
</dd>
</dl>
</section>
<section id="how-callbacks-are-called">
<span id="optparse-how-callbacks-called"></span><h3>Cómo son invocadas las retrollamadas<a class="headerlink" href="#how-callbacks-are-called" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Todas las retrollamadas son invocadas de la siguiente forma:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">func</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">opt_str</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">parser</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>donde</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">option</span></code></dt><dd><p>es la instancia de Option que invoca a la retrollamada</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">opt_str</span></code></dt><dd><p>es la cadena de opción encontrada en la línea de comandos que activa la retrollamada. (Si se utilizó una opción larga abreviada, <code class="docutils literal notranslate"><span class="pre">opt_str</span></code> será la cadena de opción canónica completa— por ejemplo, si el usuario ingresa <code class="docutils literal notranslate"><span class="pre">--foo</span></code> en la línea de comandos como una abreviatura de <code class="docutils literal notranslate"><span class="pre">--foobar</span></code>, entonces <code class="docutils literal notranslate"><span class="pre">opt_str</span></code> será <code class="docutils literal notranslate"><span class="pre">&quot;--foobar&quot;</span></code>.)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">value</span></code></dt><dd><p>es el argumento de esta opción encontrado en la línea de comandos. <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> solo esperará un argumento si <a class="reference internal" href="#optparse.Option.type" title="optparse.Option.type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">type</span></code></a> está establecido. El tipo de <code class="docutils literal notranslate"><span class="pre">value</span></code> será el tipo implícito en el tipo de la propia opción. Si <a class="reference internal" href="#optparse.Option.type" title="optparse.Option.type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">type</span></code></a> es <code class="docutils literal notranslate"><span class="pre">None</span></code> para esta opción (no se espera ningún argumento), entonces <code class="docutils literal notranslate"><span class="pre">value</span></code> será también <code class="docutils literal notranslate"><span class="pre">None</span></code>. Si <a class="reference internal" href="#optparse.Option.nargs" title="optparse.Option.nargs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nargs</span></code></a> es mayor que 1, <code class="docutils literal notranslate"><span class="pre">value</span></code> será una tupla con los valores del tipo apropiado.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">parser</span></code></dt><dd><p>es la instancia de OptionParser que controla todo. Su utilidad principal radica en que permite acceder a otros datos de interés a través de sus atributos de instancia:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">parser.largs</span></code></dt><dd><p>la lista actual de argumentos que sobran, es decir, argumentos que se han consumido pero que no son opciones ni argumentos de opción. Siéntete libre de modificar <code class="docutils literal notranslate"><span class="pre">parser.largs</span></code>, por ejemplo, agregando más argumentos. (Esta lista se convertirá en <code class="docutils literal notranslate"><span class="pre">args</span></code>, el segundo valor de retorno del método <code class="xref py py-meth docutils literal notranslate"><span class="pre">parse_args()</span></code>.)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">parser.rargs</span></code></dt><dd><p>la lista actual de argumentos restantes, es decir, los argumentos que quedan a continuación de <code class="docutils literal notranslate"><span class="pre">opt_str</span></code> y <code class="docutils literal notranslate"><span class="pre">value</span></code> (si corresponde), una vez eliminados ambos. Siéntete libre de modificar <code class="docutils literal notranslate"><span class="pre">parser.rargs</span></code>, por ejemplo, consumiendo más argumentos.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">parser.values</span></code></dt><dd><p>el objeto donde los valores de las opciones son almacenados por defecto (una instancia de <em>optparse.OptionValues</em>). Esto permite que las retrollamadas utilicen el mismo mecanismo que el resto de <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> para almacenar valores de las opciones; no es necesario perder el tiempo con globales o clausuras. También se puede acceder a los valores de las opciones o modificarlos si ya se encuentran en la línea de comandos.</p>
</dd>
</dl>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">args</span></code></dt><dd><p>es una tupla de argumentos posicionales arbitrarios suministrados a través del atributo de opción <a class="reference internal" href="#optparse.Option.callback_args" title="optparse.Option.callback_args"><code class="xref py py-attr docutils literal notranslate"><span class="pre">callback_args</span></code></a>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">kwargs</span></code></dt><dd><p>es un diccionario con argumentos por palabra clave arbitrarios proporcionados por <a class="reference internal" href="#optparse.Option.callback_kwargs" title="optparse.Option.callback_kwargs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">callback_kwargs</span></code></a>.</p>
</dd>
</dl>
</section>
<section id="raising-errors-in-a-callback">
<span id="optparse-raising-errors-in-callback"></span><h3>Lanzando errores en una retrollamada<a class="headerlink" href="#raising-errors-in-a-callback" title="Enlazar permanentemente con este título">¶</a></h3>
<p>La retrollamada debería lanzar una excepción <code class="xref py py-exc docutils literal notranslate"><span class="pre">OptionValueError</span></code> si hay algún problema con la opción o su(s) argumento(s). Esto permite a <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> detectar el problema y finalizar el programa, imprimiendo el mensaje de error que hayas proporciones en la salida de error estándar. El mensaje debe ser claro, conciso, preciso y mencionar la opción que causa la excepción. De lo contrario, el usuario tendrá dificultades para descubrir qué hizo mal.</p>
</section>
<section id="callback-example-1-trivial-callback">
<span id="optparse-callback-example-1"></span><h3>Ejemplo de retrollamada 1: una retrollamada trivial<a class="headerlink" href="#callback-example-1-trivial-callback" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Aquí hay un ejemplo de una opción con retrollamada que no tiene argumentos y simplemente registra que se encontró la opción en la línea de comandos:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">record_foo_seen</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">opt_str</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">saw_foo</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;--foo&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;callback&quot;</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">record_foo_seen</span><span class="p">)</span>
</pre></div>
</div>
<p>Ciertamente, se puede hacer lo mismo simplemente con la acción <code class="docutils literal notranslate"><span class="pre">&quot;store_true&quot;</span></code>.</p>
</section>
<section id="callback-example-2-check-option-order">
<span id="optparse-callback-example-2"></span><h3>Ejemplo de retrollamada 2: comprobar el orden de las opciones<a class="headerlink" href="#callback-example-2-check-option-order" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Aquí tenemos un ejemplo un poco más interesante: registra el hecho de que se ha encontrado <code class="docutils literal notranslate"><span class="pre">-a</span></code>, pero lanza un error si viene después de <code class="docutils literal notranslate"><span class="pre">-b</span></code> en la línea de comandos</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_order</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">opt_str</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">parser</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">b</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">OptionValueError</span><span class="p">(</span><span class="s2">&quot;can&#39;t use -a after -b&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">...</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-a&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;callback&quot;</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">check_order</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-b&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="callback-example-3-check-option-order-generalized">
<span id="optparse-callback-example-3"></span><h3>Ejemplo de retrollamada 3: comprobar el orden de las opciones (generalizado)<a class="headerlink" href="#callback-example-3-check-option-order-generalized" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Si deseas reutilizar esta misma retrollamada para varias opciones similares (establecer un flag, pero lanzar un error si ya se ha encontrado <code class="docutils literal notranslate"><span class="pre">-b</span></code>), necesitas un poco más de trabajo: tanto el mensaje de error como el flag que estableces deben generalizarse:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_order</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">opt_str</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">parser</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">b</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">OptionValueError</span><span class="p">(</span><span class="s2">&quot;can&#39;t use </span><span class="si">%s</span><span class="s2"> after -b&quot;</span> <span class="o">%</span> <span class="n">opt_str</span><span class="p">)</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">option</span><span class="o">.</span><span class="n">dest</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-a&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;callback&quot;</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">check_order</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-b&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;callback&quot;</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">check_order</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="callback-example-4-check-arbitrary-condition">
<span id="optparse-callback-example-4"></span><h3>Ejemplo de retrollamada 4: comprobar una condición arbitraria<a class="headerlink" href="#callback-example-4-check-arbitrary-condition" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Por supuesto, puedes poner cualquier condición aquí, no estás limitado a verificar los valores de las opciones previamente definidas. Por ejemplo, si tienes opciones que no deberían llamarse cuando hay luna llena, todo lo que tienes que hacer es lo siguiente:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_moon</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">opt_str</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">is_moon_full</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">OptionValueError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> option invalid when moon is full&quot;</span>
                               <span class="o">%</span> <span class="n">opt_str</span><span class="p">)</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">option</span><span class="o">.</span><span class="n">dest</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;--foo&quot;</span><span class="p">,</span>
                  <span class="n">action</span><span class="o">=</span><span class="s2">&quot;callback&quot;</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">check_moon</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>(La definición de <code class="docutils literal notranslate"><span class="pre">is_moon_full()</span></code> se deja como ejercicio para el lector).</p>
</section>
<section id="callback-example-5-fixed-arguments">
<span id="optparse-callback-example-5"></span><h3>Ejemplo de retrollamada 5: argumentos fijos<a class="headerlink" href="#callback-example-5-fixed-arguments" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Las cosas se ponen un poco más interesantes cuando se definen opciones con retrollamada que toman un número fijo de argumentos. Especificar que una opción con retrollamada toma argumentos es similar a definir una opción <code class="docutils literal notranslate"><span class="pre">&quot;store&quot;</span></code> o <code class="docutils literal notranslate"><span class="pre">&quot;append&quot;</span></code>: si se define <a class="reference internal" href="#optparse.Option.type" title="optparse.Option.type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">type</span></code></a>, entonces la opción toma un argumento que debe poder convertirse a ese tipo; si además se define <a class="reference internal" href="#optparse.Option.nargs" title="optparse.Option.nargs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nargs</span></code></a>, entonces la opción toma <a class="reference internal" href="#optparse.Option.nargs" title="optparse.Option.nargs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nargs</span></code></a> argumentos.</p>
<p>Aquí hay un ejemplo que simplemente emula la acción <code class="docutils literal notranslate"><span class="pre">&quot;store&quot;</span></code> estándar:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">store_value</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">opt_str</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">option</span><span class="o">.</span><span class="n">dest</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;--foo&quot;</span><span class="p">,</span>
                  <span class="n">action</span><span class="o">=</span><span class="s2">&quot;callback&quot;</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">store_value</span><span class="p">,</span>
                  <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Ten en cuenta que <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> se encarga de consumir 3 argumentos y convertirlos a números enteros por ti; todo lo que tienes que hacer es almacenarlos. (En cualquier caso, obviamente no necesitas hacer uso de una retrollamada para este ejemplo).</p>
</section>
<section id="callback-example-6-variable-arguments">
<span id="optparse-callback-example-6"></span><h3>Ejemplo de retrollamada 6: argumentos variables<a class="headerlink" href="#callback-example-6-variable-arguments" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Las cosas se complican si quieres que una opción pueda tomar un número variable de argumentos. En este caso, si que deberás escribir una retrollamada, ya que el módulo <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> no proporciona ninguna capacidad incorporada para ello. Además, tienes que lidiar con ciertos entresijos del análisis convencional de la línea de comandos de Unix, que <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> normalmente maneja por ti. En concreto, las retrollamadas deben implementar las reglas convencionales para los argumentos <code class="docutils literal notranslate"><span class="pre">--</span></code> y <code class="docutils literal notranslate"><span class="pre">-</span></code> desnudos:</p>
<ul class="simple">
<li><p>tanto <code class="docutils literal notranslate"><span class="pre">--</span></code> como <code class="docutils literal notranslate"><span class="pre">-</span></code> pueden ser argumentos de opción</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--</span></code> desnudo (si no es el argumento de alguna opción): detener el procesamiento de la línea de comandos y descartar el <code class="docutils literal notranslate"><span class="pre">--</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-</span></code> desnudo (si no es el argumento de alguna opción): detener el procesamiento de la línea de comandos pero mantener el <code class="docutils literal notranslate"><span class="pre">-</span></code> (añadiéndolo a <code class="docutils literal notranslate"><span class="pre">parser.largs</span></code>)</p></li>
</ul>
<p>Si deseas que una opción tenga un número variable de argumentos, hay varios problemas sutiles y complicados de los que deberás preocuparte. La implementación exacta que elijas dependerá de los sacrificios que estés dispuesto a hacer en tu aplicación (razón por la cual, el módulo <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> no admite directamente este tipo de cosas).</p>
<p>En cualquier caso, aquí hay un intento de una retrollamada para una opción con un número de argumentos variable:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">vararg_callback</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">opt_str</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span>
    <span class="n">value</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">floatable</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">parser</span><span class="o">.</span><span class="n">rargs</span><span class="p">:</span>
        <span class="c1"># stop on --foo like options</span>
        <span class="k">if</span> <span class="n">arg</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;--&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="c1"># stop on -a, but not on -3 or -3.0</span>
        <span class="k">if</span> <span class="n">arg</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">floatable</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="n">value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

    <span class="k">del</span> <span class="n">parser</span><span class="o">.</span><span class="n">rargs</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)]</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">option</span><span class="o">.</span><span class="n">dest</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

<span class="o">...</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="s2">&quot;--callback&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;vararg_attr&quot;</span><span class="p">,</span>
                  <span class="n">action</span><span class="o">=</span><span class="s2">&quot;callback&quot;</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">vararg_callback</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="extending-optparse">
<span id="optparse-extending-optparse"></span><h2>Extendiendo el módulo <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a><a class="headerlink" href="#extending-optparse" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Dado que los dos factores principales que controlan como el módulo <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> interpreta las opciones de la línea de comandos son la acción y el tipo de cada opción, los objetivos más probables de extensión son agregar nuevas acciones y nuevos tipos.</p>
<section id="adding-new-types">
<span id="optparse-adding-new-types"></span><h3>Agregando nuevos tipos<a class="headerlink" href="#adding-new-types" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Para añadir nuevos tipos, necesitas definir tu propia subclase de la clase <code class="xref py py-class docutils literal notranslate"><span class="pre">Option</span></code> de <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a>. Esta clase tiene un par de atributos que definen los tipos de <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a>: <a class="reference internal" href="#optparse.Option.TYPES" title="optparse.Option.TYPES"><code class="xref py py-attr docutils literal notranslate"><span class="pre">TYPES</span></code></a> y <a class="reference internal" href="#optparse.Option.TYPE_CHECKER" title="optparse.Option.TYPE_CHECKER"><code class="xref py py-attr docutils literal notranslate"><span class="pre">TYPE_CHECKER</span></code></a>.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="optparse.Option.TYPES">
<span class="sig-prename descclassname"><span class="pre">Option.</span></span><span class="sig-name descname"><span class="pre">TYPES</span></span><a class="headerlink" href="#optparse.Option.TYPES" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>Una tupla con nombres de tipos. En tu subclase, simplemente define una nueva tupla <a class="reference internal" href="#optparse.Option.TYPES" title="optparse.Option.TYPES"><code class="xref py py-attr docutils literal notranslate"><span class="pre">TYPES</span></code></a> que se base en la estándar.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optparse.Option.TYPE_CHECKER">
<span class="sig-prename descclassname"><span class="pre">Option.</span></span><span class="sig-name descname"><span class="pre">TYPE_CHECKER</span></span><a class="headerlink" href="#optparse.Option.TYPE_CHECKER" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>Un diccionario que asigna nombres de tipos a funciones de verificación de tipo. Una función de verificación de tipo tiene la siguiente firma:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_mytype</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
<p>donde <code class="docutils literal notranslate"><span class="pre">option</span></code> es una instancia de <code class="xref py py-class docutils literal notranslate"><span class="pre">Option</span></code>, <code class="docutils literal notranslate"><span class="pre">opt</span></code> es una cadena de opción (por ejemplo, <code class="docutils literal notranslate"><span class="pre">-f</span></code>) y <code class="docutils literal notranslate"><span class="pre">value</span></code> es la cadena de caracteres de la línea de comandos que debe comprobarse y convertirse al tipo deseado. <code class="docutils literal notranslate"><span class="pre">check_mytype()</span></code> debería retornar un objeto del tipo hipotético <code class="docutils literal notranslate"><span class="pre">mytype</span></code>. El valor retornado por una función de verificación de tipo terminará formando parte de la instancia de OptionValues retornada por el método <code class="xref py py-meth docutils literal notranslate"><span class="pre">OptionParser.parse_args()</span></code> o será pasada a una retrollamada como parámetro <code class="docutils literal notranslate"><span class="pre">value</span></code>.</p>
<p>Tu función de verificación de tipo debería lanzar una excepción <code class="xref py py-exc docutils literal notranslate"><span class="pre">OptionValueError</span></code> si encuentra algún problema. <code class="xref py py-exc docutils literal notranslate"><span class="pre">OptionValueError</span></code> toma una cadena de caracteres como único argumento, que es pasada tal cual al método <code class="xref py py-meth docutils literal notranslate"><span class="pre">error()</span></code> de la clase <a class="reference internal" href="#optparse.OptionParser" title="optparse.OptionParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptionParser</span></code></a>, que a su vez antepone a la misma el nombre del programa y la cadena <code class="docutils literal notranslate"><span class="pre">&quot;error:&quot;</span></code> e imprime todo en la salida de error estándar antes de finalizar el proceso.</p>
</dd></dl>

<p>Aquí hay un ejemplo absurdo que demuestra cómo agregar un tipo de opción <code class="docutils literal notranslate"><span class="pre">&quot;complex&quot;</span></code> para analizar números complejos al estilo Python en la línea de comandos. (Esto es aún más absurdo de lo que en principio parece, porque en al versión 1.3 de <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> se agregó soporte incorporado para números complejos, pero no importa).</p>
<p>Primero, las importaciones necesarias:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span>
<span class="kn">from</span> <span class="nn">optparse</span> <span class="kn">import</span> <span class="n">Option</span><span class="p">,</span> <span class="n">OptionValueError</span>
</pre></div>
</div>
<p>En primer lugar, debes definir tu verificador de tipo, ya que se hace referencia a él más adelante (en el atributo de clase <a class="reference internal" href="#optparse.Option.TYPE_CHECKER" title="optparse.Option.TYPE_CHECKER"><code class="xref py py-attr docutils literal notranslate"><span class="pre">TYPE_CHECKER</span></code></a> de tu subclase de Option):</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_complex</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">complex</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">OptionValueError</span><span class="p">(</span>
            <span class="s2">&quot;option </span><span class="si">%s</span><span class="s2">: invalid complex value: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
</pre></div>
</div>
<p>Finalmente, la subclase de Option:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyOption</span> <span class="p">(</span><span class="n">Option</span><span class="p">):</span>
    <span class="n">TYPES</span> <span class="o">=</span> <span class="n">Option</span><span class="o">.</span><span class="n">TYPES</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;complex&quot;</span><span class="p">,)</span>
    <span class="n">TYPE_CHECKER</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">Option</span><span class="o">.</span><span class="n">TYPE_CHECKER</span><span class="p">)</span>
    <span class="n">TYPE_CHECKER</span><span class="p">[</span><span class="s2">&quot;complex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">check_complex</span>
</pre></div>
</div>
<p>(Si no hacemos una copia (mediante <a class="reference internal" href="copy.html#module-copy" title="copy: Shallow and deep copy operations."><code class="xref py py-func docutils literal notranslate"><span class="pre">copy()</span></code></a>), de <a class="reference internal" href="#optparse.Option.TYPE_CHECKER" title="optparse.Option.TYPE_CHECKER"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Option.TYPE_CHECKER</span></code></a>, terminaríamos modificando el atributo <a class="reference internal" href="#optparse.Option.TYPE_CHECKER" title="optparse.Option.TYPE_CHECKER"><code class="xref py py-attr docutils literal notranslate"><span class="pre">TYPE_CHECKER</span></code></a> de la clase Option de <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a>. Tratándose de Python, nada te impide hacer eso, excepto los buenos modales y el sentido común.)</p>
<p>¡Y eso es todo! Ahora puedes escribir un script que use tu nuevo tipo de opción como cualquier otro script basado en <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a>, excepto que debes indicarle a tu OptionParser que use MyOption en lugar de Option:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">(</span><span class="n">option_class</span><span class="o">=</span><span class="n">MyOption</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;complex&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternativamente, puedes crear tu propia lista de opciones y pasarla a OptionParser; si no usas <code class="xref py py-meth docutils literal notranslate"><span class="pre">add_option()</span></code> de la manera anterior, no necesitas decirle a OptionParser qué clase de opción usar:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">option_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">MyOption</span><span class="p">(</span><span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;complex&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">)]</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">(</span><span class="n">option_list</span><span class="o">=</span><span class="n">option_list</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="adding-new-actions">
<span id="optparse-adding-new-actions"></span><h3>Agregando nuevas acciones<a class="headerlink" href="#adding-new-actions" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Agregar nuevas acciones es un poco más complicado, dado que hay que comprender que <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> establece un par de categorías para las acciones:</p>
<dl class="simple">
<dt>Acciones «store»</dt><dd><p>acciones que dan como resultado que <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> almacene un valor en un atributo de la instancia actual de OptionValues. Estas opciones requieren un atributo <a class="reference internal" href="#optparse.Option.dest" title="optparse.Option.dest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dest</span></code></a> para que pueda ser proporcionado al constructor de Option.</p>
</dd>
<dt>Acciones «typed»</dt><dd><p>acciones que toman un valor de la línea de comandos, esperando que sea de cierto tipo; o mejor dicho, una cadena de caracteres que se pueda convertir a un determinado tipo. Estas opciones requieren un atributo <a class="reference internal" href="#optparse.Option.type" title="optparse.Option.type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">type</span></code></a> para el constructor de Option.</p>
</dd>
</dl>
<p>Ambas categorías se solapan entre si: algunas acciones <code class="docutils literal notranslate"><span class="pre">store</span></code> predeterminadas son <code class="docutils literal notranslate"><span class="pre">&quot;store&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;store_const&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;append&quot;</span></code> y <code class="docutils literal notranslate"><span class="pre">&quot;count&quot;</span></code>, mientras que las acciones «typed» predeterminadas son <code class="docutils literal notranslate"><span class="pre">&quot;store&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;append&quot;</span></code> y <code class="docutils literal notranslate"><span class="pre">&quot;callback&quot;</span></code>.</p>
<p>Cuando agregas una acción, debes categorizarla enumerándola en al menos uno de los siguientes atributos de clase de la clase Option (todos ellos son listas de cadenas de caracteres):</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="optparse.Option.ACTIONS">
<span class="sig-prename descclassname"><span class="pre">Option.</span></span><span class="sig-name descname"><span class="pre">ACTIONS</span></span><a class="headerlink" href="#optparse.Option.ACTIONS" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>Todas las acciones deben aparecer en ACTIONS.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optparse.Option.STORE_ACTIONS">
<span class="sig-prename descclassname"><span class="pre">Option.</span></span><span class="sig-name descname"><span class="pre">STORE_ACTIONS</span></span><a class="headerlink" href="#optparse.Option.STORE_ACTIONS" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>Las acciones «store» también se enumeran aquí.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optparse.Option.TYPED_ACTIONS">
<span class="sig-prename descclassname"><span class="pre">Option.</span></span><span class="sig-name descname"><span class="pre">TYPED_ACTIONS</span></span><a class="headerlink" href="#optparse.Option.TYPED_ACTIONS" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>Las acciones «typed» también se enumeran aquí.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optparse.Option.ALWAYS_TYPED_ACTIONS">
<span class="sig-prename descclassname"><span class="pre">Option.</span></span><span class="sig-name descname"><span class="pre">ALWAYS_TYPED_ACTIONS</span></span><a class="headerlink" href="#optparse.Option.ALWAYS_TYPED_ACTIONS" title="Enlazar permanentemente con esta definición">¶</a></dt>
<dd><p>Las acciones que siempre toman un tipo (es decir, aquellas cuyas opciones siempre toman un valor) también deben enumerarse aquí. La única consecuencia de esto es que <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> asigna el tipo predeterminado, <code class="docutils literal notranslate"><span class="pre">string</span></code>, a las opciones cuya acción se enumera en <a class="reference internal" href="#optparse.Option.ALWAYS_TYPED_ACTIONS" title="optparse.Option.ALWAYS_TYPED_ACTIONS"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ALWAYS_TYPED_ACTIONS</span></code></a> pero que no tienen asignado un tipo explícito.</p>
</dd></dl>

<p>Para implementar realmente tu nueva acción, debes redefinir el método <code class="xref py py-meth docutils literal notranslate"><span class="pre">take_action()</span></code> de Option, implementando un nuevo método que reconozca tu acción.</p>
<p>Por ejemplo, agreguemos una nueva acción <code class="docutils literal notranslate"><span class="pre">&quot;extend&quot;</span></code>. Esta es similar a la acción estándar <code class="docutils literal notranslate"><span class="pre">&quot;append&quot;</span></code>, pero en lugar de tomar un solo valor de la línea de comandos y agregarlo a una lista existente, <code class="docutils literal notranslate"><span class="pre">&quot;extend&quot;</span></code> tomará múltiples valores en una sola cadena de caracteres delimitada por comas y amplía una lista previamente existente con ellos. Es decir, si <code class="docutils literal notranslate"><span class="pre">--names</span></code> es una opción <code class="docutils literal notranslate"><span class="pre">&quot;extend&quot;</span></code> de tipo <code class="docutils literal notranslate"><span class="pre">&quot;string&quot;</span></code>, la línea de comandos</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="o">--</span><span class="n">names</span><span class="o">=</span><span class="n">foo</span><span class="p">,</span><span class="n">bar</span> <span class="o">--</span><span class="n">names</span> <span class="n">blah</span> <span class="o">--</span><span class="n">names</span> <span class="n">ding</span><span class="p">,</span><span class="n">dong</span>
</pre></div>
</div>
<p>daría como resultado una lista como la siguiente:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;blah&quot;</span><span class="p">,</span> <span class="s2">&quot;ding&quot;</span><span class="p">,</span> <span class="s2">&quot;dong&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>De nuevo, definimos una subclase de Option:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyOption</span><span class="p">(</span><span class="n">Option</span><span class="p">):</span>

    <span class="n">ACTIONS</span> <span class="o">=</span> <span class="n">Option</span><span class="o">.</span><span class="n">ACTIONS</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;extend&quot;</span><span class="p">,)</span>
    <span class="n">STORE_ACTIONS</span> <span class="o">=</span> <span class="n">Option</span><span class="o">.</span><span class="n">STORE_ACTIONS</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;extend&quot;</span><span class="p">,)</span>
    <span class="n">TYPED_ACTIONS</span> <span class="o">=</span> <span class="n">Option</span><span class="o">.</span><span class="n">TYPED_ACTIONS</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;extend&quot;</span><span class="p">,)</span>
    <span class="n">ALWAYS_TYPED_ACTIONS</span> <span class="o">=</span> <span class="n">Option</span><span class="o">.</span><span class="n">ALWAYS_TYPED_ACTIONS</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;extend&quot;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="nf">take_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;extend&quot;</span><span class="p">:</span>
            <span class="n">lvalue</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
            <span class="n">values</span><span class="o">.</span><span class="n">ensure_value</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">lvalue</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Option</span><span class="o">.</span><span class="n">take_action</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">parser</span><span class="p">)</span>
</pre></div>
</div>
<p>Detalles a tener en cuenta:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;extend&quot;</span></code> espera un valor en la línea de comandos y también almacena ese valor en algún lugar, por lo que lo agregamos tanto a <a class="reference internal" href="#optparse.Option.STORE_ACTIONS" title="optparse.Option.STORE_ACTIONS"><code class="xref py py-attr docutils literal notranslate"><span class="pre">STORE_ACTIONS</span></code></a> como a <a class="reference internal" href="#optparse.Option.TYPED_ACTIONS" title="optparse.Option.TYPED_ACTIONS"><code class="xref py py-attr docutils literal notranslate"><span class="pre">TYPED_ACTIONS</span></code></a>.</p></li>
<li><p>para asegurarnos de que <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a> asigna el tipo predeterminado <code class="docutils literal notranslate"><span class="pre">&quot;string&quot;</span></code> a las acciones <code class="docutils literal notranslate"><span class="pre">&quot;extend&quot;</span></code>, agregamos también la acción <code class="docutils literal notranslate"><span class="pre">&quot;extend&quot;</span></code> a <code class="xref py py-attr docutils literal notranslate"><span class="pre">ALWAYS_TYPED_ACTIONS</span></code>.</p></li>
<li><p>el método <code class="xref py py-meth docutils literal notranslate"><span class="pre">MyOption.take_action()</span></code> solo se encarga de implementar esta nueva acción y posteriormente le pasa el control al método <code class="xref py py-meth docutils literal notranslate"><span class="pre">Option.take_action()</span></code> para las acciones estándar de <a class="reference internal" href="#module-optparse" title="optparse: Command-line option parsing library. (obsoleto)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">values</span></code> es una instancia de la clase <em>optparse_parser.Values</em>, que proporciona el útil método <code class="xref py py-meth docutils literal notranslate"><span class="pre">ensure_value()</span></code>. El método <code class="xref py py-meth docutils literal notranslate"><span class="pre">ensure_value()</span></code> es en esencia lo mismo que <a class="reference internal" href="functions.html#getattr" title="getattr"><code class="xref py py-func docutils literal notranslate"><span class="pre">getattr()</span></code></a> pero con un mecanismo de seguridad agregado. Es llamado como:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">values</span><span class="o">.</span><span class="n">ensure_value</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
<p>Si el atributo <code class="docutils literal notranslate"><span class="pre">attr</span></code> de <code class="docutils literal notranslate"><span class="pre">values</span></code> no existe o es <code class="docutils literal notranslate"><span class="pre">None</span></code>, entonces <em>ensure_value()</em> primero lo establece en <code class="docutils literal notranslate"><span class="pre">value</span></code> y luego retorna el atributo actualizado. Esto es muy útil para acciones como <code class="docutils literal notranslate"><span class="pre">&quot;extend&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;append&quot;</span></code> y <code class="docutils literal notranslate"><span class="pre">&quot;count&quot;</span></code>, dado que todas ellas acumulan datos en una variable y esperan que esa variable sea de cierto tipo (una lista para las dos primeras, un número entero para la última). Usar el método <code class="xref py py-meth docutils literal notranslate"><span class="pre">ensure_value()</span></code> significa que los scripts que usan tu acción no tienen que preocuparse por establecer un valor predeterminado para los destinos de opción en cuestión; simplemente pueden dejar el valor predeterminado como <code class="docutils literal notranslate"><span class="pre">None</span></code> y <code class="xref py py-meth docutils literal notranslate"><span class="pre">secure_value()</span></code> se encargará de que todo esté correcto cuando sea necesario.</p>
</li>
</ul>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../contents.html">Tabla de contenido</a></h3>
    <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code> — Analizador sintáctico (parser) para opciones de línea de comandos</a><ul>
<li><a class="reference internal" href="#background">Contexto</a><ul>
<li><a class="reference internal" href="#terminology">Terminología</a></li>
<li><a class="reference internal" href="#what-are-options-for">¿Qué finalidad tienen las opciones?</a></li>
<li><a class="reference internal" href="#what-are-positional-arguments-for">¿Qué finalidad tienen los argumentos posicionales?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tutorial">Tutorial</a><ul>
<li><a class="reference internal" href="#understanding-option-actions">Comprendiendo las acciones de opción</a></li>
<li><a class="reference internal" href="#the-store-action">La acción store</a></li>
<li><a class="reference internal" href="#handling-boolean-flag-options">Manejo de opciones booleanas (flags)</a></li>
<li><a class="reference internal" href="#other-actions">Otras acciones</a></li>
<li><a class="reference internal" href="#default-values">Valores por defecto</a></li>
<li><a class="reference internal" href="#generating-help">Generando ayuda</a><ul>
<li><a class="reference internal" href="#grouping-options">Agrupando opciones</a></li>
</ul>
</li>
<li><a class="reference internal" href="#printing-a-version-string">Imprimir una cadena de caracteres con la versión del programa</a></li>
<li><a class="reference internal" href="#how-optparse-handles-errors">Cómo maneja los errores el módulo <code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a></li>
<li><a class="reference internal" href="#putting-it-all-together">Reuniendo todas las piezas</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reference-guide">Guía de referencia</a><ul>
<li><a class="reference internal" href="#creating-the-parser">Creando el analizador sintáctico (parser)</a></li>
<li><a class="reference internal" href="#populating-the-parser">Completando el analizador con opciones</a></li>
<li><a class="reference internal" href="#defining-options">Definiendo las opciones</a></li>
<li><a class="reference internal" href="#option-attributes">Atributos de opción</a></li>
<li><a class="reference internal" href="#standard-option-actions">Acciones de opción estándares</a></li>
<li><a class="reference internal" href="#standard-option-types">Tipos de opción estándares</a></li>
<li><a class="reference internal" href="#parsing-arguments">Analizando los argumentos</a></li>
<li><a class="reference internal" href="#querying-and-manipulating-your-option-parser">Consultar y manipular el analizador de opciones</a></li>
<li><a class="reference internal" href="#conflicts-between-options">Conflictos entre opciones</a></li>
<li><a class="reference internal" href="#cleanup">Limpieza</a></li>
<li><a class="reference internal" href="#other-methods">Otros métodos</a></li>
</ul>
</li>
<li><a class="reference internal" href="#option-callbacks">Retrollamadas de opción</a><ul>
<li><a class="reference internal" href="#defining-a-callback-option">Definición de una opción con retrollamada</a></li>
<li><a class="reference internal" href="#how-callbacks-are-called">Cómo son invocadas las retrollamadas</a></li>
<li><a class="reference internal" href="#raising-errors-in-a-callback">Lanzando errores en una retrollamada</a></li>
<li><a class="reference internal" href="#callback-example-1-trivial-callback">Ejemplo de retrollamada 1: una retrollamada trivial</a></li>
<li><a class="reference internal" href="#callback-example-2-check-option-order">Ejemplo de retrollamada 2: comprobar el orden de las opciones</a></li>
<li><a class="reference internal" href="#callback-example-3-check-option-order-generalized">Ejemplo de retrollamada 3: comprobar el orden de las opciones (generalizado)</a></li>
<li><a class="reference internal" href="#callback-example-4-check-arbitrary-condition">Ejemplo de retrollamada 4: comprobar una condición arbitraria</a></li>
<li><a class="reference internal" href="#callback-example-5-fixed-arguments">Ejemplo de retrollamada 5: argumentos fijos</a></li>
<li><a class="reference internal" href="#callback-example-6-variable-arguments">Ejemplo de retrollamada 6: argumentos variables</a></li>
</ul>
</li>
<li><a class="reference internal" href="#extending-optparse">Extendiendo el módulo <code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a><ul>
<li><a class="reference internal" href="#adding-new-types">Agregando nuevos tipos</a></li>
<li><a class="reference internal" href="#adding-new-actions">Agregando nuevas acciones</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Tema anterior</h4>
    <p class="topless"><a href="nntplib.html"
                          title="capítulo anterior"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nntplib</span></code> — Protocolo de cliente NNTP</a></p>
  </div>
  <div>
    <h4>Próximo tema</h4>
    <p class="topless"><a href="ossaudiodev.html"
                          title="próximo capítulo"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ossaudiodev</span></code> — Acceso a dispositivos de audio compatibles con OSS</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>Esta página</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">Reporta un bug</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/3.11/Doc/library/optparse.rst"
            rel="nofollow">Ver fuente
        </a>
      </li>
    </ul>
  </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Índice general"
             >índice</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Índice de Módulos Python"
             >módulos</a> |</li>
        <li class="right" >
          <a href="ossaudiodev.html" title="ossaudiodev — Acceso a dispositivos de audio compatibles con OSS"
             >siguiente</a> |</li>
        <li class="right" >
          <a href="nntplib.html" title="nntplib — Protocolo de cliente NNTP"
             >anterior</a> |</li>

          <li><img src="../_static/py.svg" alt="python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.11.2 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >La biblioteca estándar de Python</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="superseded.html" >Módulos reemplazados</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code> — Analizador sintáctico (parser) para opciones de línea de comandos</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Búsqueda rápida" aria-label="Búsqueda rápida" type="text" name="q" />
          <input type="submit" value="Ir" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
                     |
                </li>
            
      </ul>
    </div>  
    <div class="footer">
    &copy; <a href="../copyright.html">Copyright</a> 2001-2023, Python Software Foundation.
    <br />
    This page is licensed under the Python Software Foundation License Version 2.
    <br />
    Examples, recipes, and other code in the documentation are additionally licensed under the Zero Clause BSD License.
    <br />
    See <a href="/license.html">History and License</a> for more information.<br />
    <br />

    La Python Software Foundation es una organización sin fines de lucro.
<a href="https://www.python.org/psf/donations/">Por favor, haga una donación.</a>
<br />
    <br />

    Última actualización el mar 23, 2023.
    <a href="/bugs.html">Found a bug</a>?
    <br />

    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
    </div>

  </body>
</html>